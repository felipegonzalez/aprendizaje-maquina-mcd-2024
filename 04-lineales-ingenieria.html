<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Aprendizaje Máquina - 4&nbsp; Métodos lineales e ingenería de entradas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-regularizacion-1.html" rel="next">
<link href="./03-metodos-locales.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-lineales-ingenieria.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Métodos lineales e ingenería de entradas</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Aprendizaje Máquina</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Temario y referencias</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduccion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-principios-supervisado.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Principios de aprendizaje supervisado</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-metodos-locales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Métodos locales no estructurados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-lineales-ingenieria.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Métodos lineales e ingenería de entradas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-regularizacion-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regularización y variabilidad</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-redes-neuronales-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Redes neuronales (intro)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-intervalos-predictivos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Incertidumbre en las predicciones</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-clasificacion-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Clasificación y probabilidad</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-clasificacion-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Decisiones de clasificación</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-clasificacion-calibracion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Calibración de probabilidades</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-val-cruzada.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Entrenamiento, Validación y Prueba</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-arboles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Métodos basados en árboles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-arboles-boosting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Métodos basados en árboles: boosting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-interpretacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Interpretación de modelos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-validacion-problemas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Validación de modelos: problemas comunes</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./81-apendice-descenso.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Apéndice 1: descenso en gradiente</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./82-apendice-descenso-estocastico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Apéndice 2: Descenso estocástico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-referencias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#aprendizaje-de-coeficientes-ajuste" id="toc-aprendizaje-de-coeficientes-ajuste" class="nav-link active" data-scroll-target="#aprendizaje-de-coeficientes-ajuste"><span class="header-section-number">4.1</span> Aprendizaje de coeficientes (ajuste)</a></li>
  <li><a href="#ingeniería-de-entradas" id="toc-ingeniería-de-entradas" class="nav-link" data-scroll-target="#ingeniería-de-entradas"><span class="header-section-number">4.2</span> Ingeniería de entradas</a></li>
  <li><a href="#variables-categóricas" id="toc-variables-categóricas" class="nav-link" data-scroll-target="#variables-categóricas"><span class="header-section-number">4.3</span> Variables categóricas</a></li>
  <li><a href="#interacciones" id="toc-interacciones" class="nav-link" data-scroll-target="#interacciones"><span class="header-section-number">4.4</span> Interacciones</a>
  <ul class="collapse">
  <li><a href="#ejemplo" id="toc-ejemplo" class="nav-link" data-scroll-target="#ejemplo">Ejemplo</a></li>
  </ul></li>
  <li><a href="#ejemplo-precios-de-casas" id="toc-ejemplo-precios-de-casas" class="nav-link" data-scroll-target="#ejemplo-precios-de-casas"><span class="header-section-number">4.5</span> Ejemplo: precios de casas</a></li>
  <li><a href="#no-linealidad-y-atípicos" id="toc-no-linealidad-y-atípicos" class="nav-link" data-scroll-target="#no-linealidad-y-atípicos"><span class="header-section-number">4.6</span> No linealidad y atípicos</a></li>
  <li><a href="#no-linealidad-y-splines" id="toc-no-linealidad-y-splines" class="nav-link" data-scroll-target="#no-linealidad-y-splines"><span class="header-section-number">4.7</span> No linealidad y splines</a>
  <ul class="collapse">
  <li><a href="#ejemplo-1" id="toc-ejemplo-1" class="nav-link" data-scroll-target="#ejemplo-1">Ejemplo</a></li>
  <li><a href="#ejemplo-casas" id="toc-ejemplo-casas" class="nav-link" data-scroll-target="#ejemplo-casas">Ejemplo: casas</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Métodos lineales e ingenería de entradas</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Una de las maneras más simples que podemos intentar para predecir <span class="math inline">\(y\)</span> en función de las <span class="math inline">\(x_j\)</span>´s es mediante una suma ponderada de los valores de las <span class="math inline">\(x_j's\)</span>, usando una función de la forma</p>
<p><span class="math display">\[f_\beta (x) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p,\]</span> En este caso, escoger una función particular de esta familia, dada una muestra de entrenamiento <span class="math inline">\({\mathcal L}\)</span>, consiste en encontrar encontrar valores apropiados de las <span class="math inline">\(\beta\)</span>’s, para construir un predictor:</p>
<p><span class="math display">\[\hat{f}(x) = \hat{\beta}_0 + \hat{\beta}_1 x_1 + \hat{\beta}_2 x_2 \cdots + \hat{\beta} x_p\]</span> y usaremos esta función <span class="math inline">\(\hat{f}\)</span> para hacer predicciones <span class="math inline">\(\hat{y} =\hat{f}(x)\)</span>.</p>
<section id="ejemplos" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="ejemplos">Ejemplos</h4>
<p>Queremos predecir las ventas futuras anuales <span class="math inline">\(y\)</span> de una tienda que se va a construir en un lugar dado. Las variables que describen el lugar son <span class="math inline">\(x_1 = trafico\_peatones\)</span>, <span class="math inline">\(x_2=trafico\_coches\)</span>. En una aproximación simple, podemos suponer que la tienda va a capturar una fracción de esos tráficos que se van a convertir en ventas. Quisieramos predecir con una función de la forma <span class="math display">\[f_\beta (peatones, coches) = \beta_0 + \beta_1\, peatones + \beta_2\, coches.\]</span> Por ejemplo, después de un análisis estimamos que</p>
<ul>
<li><span class="math inline">\(\hat{\beta}_0 = 1000000\)</span> (ventas base, si observamos tráficos igual a 0: es lo que va a atraer la tienda)</li>
<li><span class="math inline">\(\hat{\beta}_1 = (200)*0.02 = 4\)</span> (capturamos 2% del tráfico peatonal, y cada capturado gasta 200 pesos)</li>
<li><span class="math inline">\(\hat{\beta}_2 = (300)*0.01 =3\)</span> (capturamos 1% del tráfico de autos, y cada capturado gasta 300 pesos)</li>
</ul>
<p>Entonces haríamos predicciones con <span class="math display">\[\hat{f}(peatones, coches) = 1000000 +  4\,peatones + 3\, coches.\]</span> El modelo lineal es más flexible de lo que parece en una primera aproximación, porque tenemos libertad para construir las variables de entrada a partir de nuestros datos. Por ejemplo, si tenemos una tercera variable <span class="math inline">\(estacionamiento\)</span> que vale 1 si hay un estacionamiento cerca o 0 si no lo hay, podríamos definir las variables</p>
<ul>
<li><span class="math inline">\(x_1= peatones\)</span></li>
<li><span class="math inline">\(x_2 = coches\)</span></li>
<li><span class="math inline">\(x_3 = estacionamiento\)</span></li>
<li><span class="math inline">\(x_4 = coches*estacionamiento\)</span></li>
</ul>
<p>Donde la idea de agregar <span class="math inline">\(x_4\)</span> es que si hay estacionamiento entonces vamos a capturar una fracción adicional del trafico de coches, y la idea de <span class="math inline">\(x_3\)</span> es que la tienda atraerá más nuevas visitas si hay un estacionamiento cerca. Buscamos ahora modelos de la forma <span class="math display">\[f_\beta(x_1,x_2,x_3,x_4) = \beta_0 + \beta_1x_1 + \beta_2 x_2 + \beta_3 x_3 +\beta_4 x_4\]</span> y podríamos obtener después de nuestra análisis las estimaciones - <span class="math inline">\(\hat{\beta}_0 = 800000\)</span> (ventas base) - <span class="math inline">\(\hat{\beta}_1 = 4\)</span> - <span class="math inline">\(\hat{\beta}_2 = (300)*0.005 = 1.5\)</span> - <span class="math inline">\(\hat{\beta}_3 = 400000\)</span> (ingreso adicional si hay estacionamiento por nuevo tráfico) - <span class="math inline">\(\hat{\beta}_4 = (300)*0.02 = 6\)</span> (ingreso adicional por tráfico de coches si hay estacionamiento)</p>
<p>y entonces haríamos predicciones con el modelo <span class="math display">\[\hat{f} (x_1,x_2,x_3,x_4) = 800000 + 4\, x_1 + 1.5 \,x_2 + 400000\, x_3 +6\, x_4\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Variables derivadas
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nótese que cuando usamos modelos lineales, es necesario considerar qué entradas usar para construir el modelo de forma que la estructura lineal sea razonable.</p>
<ul>
<li>Estas entradas son construidas a partir de las variables originales</li>
<li>Agregar variables tiene dos efectos: disminuyen el sesgo, y también puede reducir el error irreducible.</li>
<li>Omitir o simplificar estos modelos disminuye típicamente la varianza pero puede aumentar el sesgo.</li>
</ul>
</div>
</div>
<p>En este caso particular, teníamos peatones, coches y estacionamiento, pero construimos también el producto de tráfico de coches y estacionamiento, pues la relación de ventas con coches es diferente dependiendo de sí la tienda tiene estacionamiento o no.</p>
</section>
<section id="aprendizaje-de-coeficientes-ajuste" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="aprendizaje-de-coeficientes-ajuste"><span class="header-section-number">4.1</span> Aprendizaje de coeficientes (ajuste)</h2>
<p>En el ejemplo anterior, los coeficientes fueron calculados (o estimados) usando experiencia, reglas, argumentos teóricos, o quizá otras fuentes de datos (como estudios o encuestas, conteos, etc.)</p>
<p>Ahora quisiéramos construir un algoritmo para aprender estos coeficientes del modelo <span class="math display">\[f_\beta (x) = \beta_0 + \beta_1 x_1 + \cdots \beta_p x_p\]</span> a partir de una muestra de entrenamiento de datos históricos de tiendas que hemos abierto antes: <span class="math display">\[{\mathcal L}=\{ (x^{(1)},y^{(1)}),(x^{(2)},y^{(2)}), \ldots, (x^{(N)}, y^{(N)}) \}\]</span> El criterio de ajuste (algoritmo de aprendizaje) más usual para regresión lineal es el de <strong>mínimos cuadrados</strong>.</p>
<p>Construimos las predicciones (ajustados) para la muestra de entrenamiento: <span class="math display">\[ f_\beta (x^{(i)}) = \beta_0 + \beta_1 x_1^{(i)}+ \cdots + \beta_p x_p^{(i)}\]</span></p>
<p>Y consideramos las diferencias de los ajustados con los valores observados:</p>
<p><span class="math display">\[e^{(i)} = y^{(i)} - f_\beta (x^{(i)})\]</span></p>
<p>La idea entonces es minimizar la suma de los residuales al cuadrado, para intentar que la función ajustada pase lo más cercana a los puntos de entrenamiento que sea posible. La función de pérdida que utilizamos más frecuentemente es la pérdida cuadrática, dada por:</p>
<p><span class="math display">\[L(\beta) = \frac{1}{N}\sum_{i=1}^N (y^{(i)} - f_\beta(x^{(i)}))^2\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mínimos cuadrados para regresión lineal
</div>
</div>
<div class="callout-body-container callout-body">
<p>Buscamos encontrar: <span class="math display">\[\hat{\beta} = \mathrm{arg\,min}_{\beta} L(\beta) = \mathrm{arg\,min}_{\beta}\frac{1}{N}\sum_{i=1}^N (y^{(i)} - f_\beta(x^{(i)}))^2\]</span> donde <span class="math display">\[f_\beta (x^{(i)}) = \beta_0 + \beta_1 x_1^{(i)}+ \cdots + \beta_p x_p^{(i)}\]</span></p>
</div>
</div>
<p>Hay varias maneras de resolver este problema: puede hacerse analíticamente con álgebra lineal, o con algún método numérico como descenso máximo (que puede escalarse fácilmente). Típicamente la función objetivo es convexa, y la solución es única, excepto en casos degenerados que podremos evitar más adelante usando regularización.</p>
<p><strong>Observación</strong>: Como discutimos al final de la sección anterior, minimizar directamente el error de entrenamiento para encontrar los coeficientes puede resultar en en un modelo sobreajustado/con varianza alta/ruidoso. Hay cuatro grandes estrategias para mitigar este problema: restringir o estructurar la familia de funciones, penalizar la función objetivo, perturbar la muestra de entrenamiento, o cambiar el proceso de minimización perturbando la función objetivo en cada paso o deteniendo el proceso antes de llegar a un mínimo sobreajustado. El método mas común es cambiar la función objetivo, que discutiremos más adelante en la sección de regularización.</p>
</section>
<section id="ingeniería-de-entradas" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="ingeniería-de-entradas"><span class="header-section-number">4.2</span> Ingeniería de entradas</h2>
<p>Algunas veces, encontrar la estructura apropiada puede requerir más trabajo que simplemente escoger una familia de modelos. Por ejemplo, en el caso de precios de casa, vimos que podríamos mejorar el ajuste haciendo que el coeficiente de área habitable dependiera de la calidad de los terminados (<a href="01-introduccion.html#sec-medicioncostosa" class="quarto-xref"><span>Sección 1.3</span></a>).</p>
<p>Usualmente tendremos que hacer varias transformaciones para obtener buen desempeño de un modelo lineal. En la siguientes secciones mostramos algunas de las más usuales.</p>
</section>
<section id="variables-categóricas" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="variables-categóricas"><span class="header-section-number">4.3</span> Variables categóricas</h2>
<p>En primer lugar, podemos incluir variables categóricas creando variables numéricas 0-1 para cada categoría. Por ejemplo para la variable calidad sótano:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../R/casas_traducir_geo.R"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">83</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>casas_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(casas, <span class="at">prop =</span> <span class="fl">0.75</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>casas_entrena <span class="ot">&lt;-</span> <span class="fu">training</span>(casas_split)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>casas_entrena <span class="sc">|&gt;</span> <span class="fu">count</span>(calidad_sotano)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  calidad_sotano     n
  &lt;chr&gt;          &lt;int&gt;
1 Ex                89
2 Fa                23
3 Gd               457
4 TA               500
5 &lt;NA&gt;              26</code></pre>
</div>
</div>
<p>El mejor nivel es Ex (excelente), luego sigue Gd (bueno), luego Fa (razonable) y finalmente TA (típico)). Hay otro nivel Po (Malo) que no aparece en estos datos.</p>
<p>En primer lugar, podemos codificar los valores faltantes, que en este caso indican casas sin sótano:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>receta_na <span class="ot">&lt;-</span> <span class="fu">recipe</span>(<span class="sc">~</span> calidad_sotano, casas_entrena) <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(calidad_sotano, <span class="at">new_level =</span> <span class="st">"no_sótano"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_relevel</span>(calidad_sotano, <span class="at">ref_level =</span> <span class="st">"TA"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>casas_preproc <span class="ot">&lt;-</span> <span class="fu">prep</span>(receta_na) <span class="sc">|&gt;</span> <span class="fu">juice</span>()</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>casas_preproc <span class="sc">|&gt;</span> <span class="fu">count</span>(calidad_sotano)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  calidad_sotano     n
  &lt;fct&gt;          &lt;int&gt;
1 TA               500
2 Ex                89
3 Fa                23
4 Gd               457
5 no_sótano         26</code></pre>
</div>
</div>
<p>Ahora convertimos a codificación dummy:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>receta_dummy <span class="ot">&lt;-</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>( <span class="sc">~</span> calidad_sotano, casas_entrena) <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(calidad_sotano, <span class="at">new_level =</span> <span class="st">"no_sótano"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_relevel</span>(calidad_sotano, <span class="at">ref_level =</span> <span class="st">"TA"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(calidad_sotano, <span class="at">keep_original_cols =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># preparar receta</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>receta_dummy_prep <span class="ot">&lt;-</span> <span class="fu">prep</span>(receta_dummy) </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># extrae los datos de entrenamiento preprocesados</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>receta_dummy_prep <span class="sc">|&gt;</span> <span class="fu">juice</span>() <span class="sc">|&gt;</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.font.size =</span> <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="bdfxkhqndy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bdfxkhqndy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bdfxkhqndy thead, #bdfxkhqndy tbody, #bdfxkhqndy tfoot, #bdfxkhqndy tr, #bdfxkhqndy td, #bdfxkhqndy th {
  border-style: none;
}

#bdfxkhqndy p {
  margin: 0;
  padding: 0;
}

#bdfxkhqndy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 10px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bdfxkhqndy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bdfxkhqndy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bdfxkhqndy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bdfxkhqndy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bdfxkhqndy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bdfxkhqndy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bdfxkhqndy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bdfxkhqndy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bdfxkhqndy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bdfxkhqndy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bdfxkhqndy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bdfxkhqndy .gt_spanner_row {
  border-bottom-style: hidden;
}

#bdfxkhqndy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bdfxkhqndy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bdfxkhqndy .gt_from_md > :first-child {
  margin-top: 0;
}

#bdfxkhqndy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bdfxkhqndy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bdfxkhqndy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bdfxkhqndy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bdfxkhqndy .gt_row_group_first td {
  border-top-width: 2px;
}

#bdfxkhqndy .gt_row_group_first th {
  border-top-width: 2px;
}

#bdfxkhqndy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bdfxkhqndy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bdfxkhqndy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bdfxkhqndy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bdfxkhqndy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bdfxkhqndy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bdfxkhqndy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bdfxkhqndy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bdfxkhqndy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bdfxkhqndy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bdfxkhqndy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bdfxkhqndy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bdfxkhqndy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bdfxkhqndy .gt_left {
  text-align: left;
}

#bdfxkhqndy .gt_center {
  text-align: center;
}

#bdfxkhqndy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bdfxkhqndy .gt_font_normal {
  font-weight: normal;
}

#bdfxkhqndy .gt_font_bold {
  font-weight: bold;
}

#bdfxkhqndy .gt_font_italic {
  font-style: italic;
}

#bdfxkhqndy .gt_super {
  font-size: 65%;
}

#bdfxkhqndy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bdfxkhqndy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bdfxkhqndy .gt_indent_1 {
  text-indent: 5px;
}

#bdfxkhqndy .gt_indent_2 {
  text-indent: 10px;
}

#bdfxkhqndy .gt_indent_3 {
  text-indent: 15px;
}

#bdfxkhqndy .gt_indent_4 {
  text-indent: 20px;
}

#bdfxkhqndy .gt_indent_5 {
  text-indent: 25px;
}

#bdfxkhqndy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bdfxkhqndy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="calidad_sotano" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">calidad_sotano</th>
<th id="calidad_sotano_Ex" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_sotano_Ex</th>
<th id="calidad_sotano_Fa" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_sotano_Fa</th>
<th id="calidad_sotano_Gd" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_sotano_Gd</th>
<th id="calidad_sotano_no_sótano" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_sotano_no_sótano</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="calidad_sotano">TA</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="calidad_sotano">Gd</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">1</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="calidad_sotano">Ex</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">1</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="calidad_sotano">Ex</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">1</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="calidad_sotano">TA</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="calidad_sotano">TA</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="calidad_sotano">TA</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="calidad_sotano">TA</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="calidad_sotano">TA</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="calidad_sotano">TA</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Nótese que no hay columna para el nivel TA, que tomamos como referencia. Incluir esta columna sería redundante, pues tenemos una constante en el predictor. En general, cuando una variable categórica tiene <span class="math inline">\(k\)</span> niveles, esta codificación produce <span class="math inline">\(k-1\)</span> columnas binarias.</p>
<p>Veamos qué pasa cuando preprocesamos datos de prueba (para después poder hacer predicciones):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>prueba_casas <span class="ot">&lt;-</span> <span class="fu">testing</span>(casas_split)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># supongamos que un nuevo nivel aparece</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>prueba_casas<span class="sc">$</span>calidad_sotano[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"no visto antes"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">bake</span>(receta_dummy_prep, prueba_casas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ! There are new levels in `calidad_sotano`: "no visto antes".
ℹ Consider using step_novel() (`?recipes::step_novel()`) \ before
  `step_unknown()` to handle unseen values.
• New levels will be coerced to `NA` by `step_unknown()`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ! There are new levels in `calidad_sotano`: NA.
ℹ Consider using step_unknown() (`?recipes::step_unknown()`) before
  `step_dummy()` to handle missing values.</code></pre>
</div>
</div>
<p>En este caso, podemos hacer nuestro flujo más robusto incluyendo un nuevo nivel en los factores donde pondremos casos no vistos. Modificamos nuestra receta:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>receta_dummy <span class="ot">&lt;-</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>( <span class="sc">~</span> calidad_sotano, casas_entrena) <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_novel</span>(calidad_sotano, <span class="at">new_level =</span> <span class="st">"nuevo"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(calidad_sotano, <span class="at">new_level =</span> <span class="st">"no_sótano"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_relevel</span>(calidad_sotano, <span class="at">ref_level =</span> <span class="st">"TA"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(calidad_sotano, <span class="at">keep_original_cols =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># preparar receta</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>receta_dummy_prep <span class="ot">&lt;-</span> <span class="fu">prep</span>(receta_dummy) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>prueba_casas <span class="ot">&lt;-</span> <span class="fu">testing</span>(casas_split)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># supongamos que un nuevo nivel aparece</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>prueba_casas<span class="sc">$</span>calidad_sotano[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"no visto antes"</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">bake</span>(receta_dummy_prep, prueba_casas)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="sc">|&gt;</span> <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">tab_options</span>(<span class="at">table.font.size =</span> <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="nzhprwefcu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nzhprwefcu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nzhprwefcu thead, #nzhprwefcu tbody, #nzhprwefcu tfoot, #nzhprwefcu tr, #nzhprwefcu td, #nzhprwefcu th {
  border-style: none;
}

#nzhprwefcu p {
  margin: 0;
  padding: 0;
}

#nzhprwefcu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 10px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nzhprwefcu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nzhprwefcu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nzhprwefcu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nzhprwefcu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nzhprwefcu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nzhprwefcu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nzhprwefcu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nzhprwefcu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nzhprwefcu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nzhprwefcu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nzhprwefcu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nzhprwefcu .gt_spanner_row {
  border-bottom-style: hidden;
}

#nzhprwefcu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nzhprwefcu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nzhprwefcu .gt_from_md > :first-child {
  margin-top: 0;
}

#nzhprwefcu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nzhprwefcu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nzhprwefcu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nzhprwefcu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nzhprwefcu .gt_row_group_first td {
  border-top-width: 2px;
}

#nzhprwefcu .gt_row_group_first th {
  border-top-width: 2px;
}

#nzhprwefcu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzhprwefcu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nzhprwefcu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nzhprwefcu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nzhprwefcu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzhprwefcu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nzhprwefcu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nzhprwefcu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nzhprwefcu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nzhprwefcu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nzhprwefcu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzhprwefcu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nzhprwefcu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzhprwefcu .gt_left {
  text-align: left;
}

#nzhprwefcu .gt_center {
  text-align: center;
}

#nzhprwefcu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nzhprwefcu .gt_font_normal {
  font-weight: normal;
}

#nzhprwefcu .gt_font_bold {
  font-weight: bold;
}

#nzhprwefcu .gt_font_italic {
  font-style: italic;
}

#nzhprwefcu .gt_super {
  font-size: 65%;
}

#nzhprwefcu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nzhprwefcu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nzhprwefcu .gt_indent_1 {
  text-indent: 5px;
}

#nzhprwefcu .gt_indent_2 {
  text-indent: 10px;
}

#nzhprwefcu .gt_indent_3 {
  text-indent: 15px;
}

#nzhprwefcu .gt_indent_4 {
  text-indent: 20px;
}

#nzhprwefcu .gt_indent_5 {
  text-indent: 25px;
}

#nzhprwefcu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nzhprwefcu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="calidad_sotano" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">calidad_sotano</th>
<th id="calidad_sotano_Ex" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_sotano_Ex</th>
<th id="calidad_sotano_Fa" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_sotano_Fa</th>
<th id="calidad_sotano_Gd" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_sotano_Gd</th>
<th id="calidad_sotano_nuevo" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_sotano_nuevo</th>
<th id="calidad_sotano_no_sótano" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_sotano_no_sótano</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="calidad_sotano">nuevo</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_nuevo">1</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="calidad_sotano">Ex</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">1</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_nuevo">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="calidad_sotano">TA</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_nuevo">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="calidad_sotano">Gd</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">1</td>
<td class="gt_row gt_right" headers="calidad_sotano_nuevo">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="calidad_sotano">TA</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_nuevo">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="calidad_sotano">TA</td>
<td class="gt_row gt_right" headers="calidad_sotano_Ex">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_nuevo">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_no_sótano">0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Y podemos ignorar el nuevo nivel al hacer predicciones (que equivale a ponerlo en la categoría de referencia, que en este caso es TA), o podemos lidiar de manera ad-hoc con este nivel.</p>
<p>Otro problema con el que podemos encontrarnos es variables categóricas que son muy ralas. Por ejemplo, una variable que tiene muchas categorías y algunas de ellas tienen muy pocos datos, además de que es probable que observemos nuevas categorías en el futuro. Por ejemplo, para la variable de zona:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>casas_entrena <span class="sc">|&gt;</span> <span class="fu">count</span>(nombre_zona) <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span> <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">tab_options</span>(<span class="at">table.font.size =</span> <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="ipwhprrhfj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ipwhprrhfj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ipwhprrhfj thead, #ipwhprrhfj tbody, #ipwhprrhfj tfoot, #ipwhprrhfj tr, #ipwhprrhfj td, #ipwhprrhfj th {
  border-style: none;
}

#ipwhprrhfj p {
  margin: 0;
  padding: 0;
}

#ipwhprrhfj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 10px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ipwhprrhfj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ipwhprrhfj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ipwhprrhfj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ipwhprrhfj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ipwhprrhfj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ipwhprrhfj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ipwhprrhfj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ipwhprrhfj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ipwhprrhfj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ipwhprrhfj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ipwhprrhfj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ipwhprrhfj .gt_spanner_row {
  border-bottom-style: hidden;
}

#ipwhprrhfj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ipwhprrhfj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ipwhprrhfj .gt_from_md > :first-child {
  margin-top: 0;
}

#ipwhprrhfj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ipwhprrhfj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ipwhprrhfj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ipwhprrhfj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ipwhprrhfj .gt_row_group_first td {
  border-top-width: 2px;
}

#ipwhprrhfj .gt_row_group_first th {
  border-top-width: 2px;
}

#ipwhprrhfj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ipwhprrhfj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ipwhprrhfj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ipwhprrhfj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ipwhprrhfj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ipwhprrhfj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ipwhprrhfj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ipwhprrhfj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ipwhprrhfj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ipwhprrhfj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ipwhprrhfj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ipwhprrhfj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ipwhprrhfj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ipwhprrhfj .gt_left {
  text-align: left;
}

#ipwhprrhfj .gt_center {
  text-align: center;
}

#ipwhprrhfj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ipwhprrhfj .gt_font_normal {
  font-weight: normal;
}

#ipwhprrhfj .gt_font_bold {
  font-weight: bold;
}

#ipwhprrhfj .gt_font_italic {
  font-style: italic;
}

#ipwhprrhfj .gt_super {
  font-size: 65%;
}

#ipwhprrhfj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ipwhprrhfj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ipwhprrhfj .gt_indent_1 {
  text-indent: 5px;
}

#ipwhprrhfj .gt_indent_2 {
  text-indent: 10px;
}

#ipwhprrhfj .gt_indent_3 {
  text-indent: 15px;
}

#ipwhprrhfj .gt_indent_4 {
  text-indent: 20px;
}

#ipwhprrhfj .gt_indent_5 {
  text-indent: 25px;
}

#ipwhprrhfj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ipwhprrhfj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="nombre_zona" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">nombre_zona</th>
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="nombre_zona">NAmes</td>
<td class="gt_row gt_right" headers="n">163</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombre_zona">CollgCr</td>
<td class="gt_row gt_right" headers="n">113</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombre_zona">OldTown</td>
<td class="gt_row gt_right" headers="n">80</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombre_zona">Edwards</td>
<td class="gt_row gt_right" headers="n">74</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombre_zona">Somerst</td>
<td class="gt_row gt_right" headers="n">65</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombre_zona">Gilbert</td>
<td class="gt_row gt_right" headers="n">61</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombre_zona">Sawyer</td>
<td class="gt_row gt_right" headers="n">59</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombre_zona">NridgHt</td>
<td class="gt_row gt_right" headers="n">58</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombre_zona">NWAmes</td>
<td class="gt_row gt_right" headers="n">57</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombre_zona">BrkSide</td>
<td class="gt_row gt_right" headers="n">45</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombre_zona">SawyerW</td>
<td class="gt_row gt_right" headers="n">42</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombre_zona">Crawfor</td>
<td class="gt_row gt_right" headers="n">39</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombre_zona">Mitchel</td>
<td class="gt_row gt_right" headers="n">36</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombre_zona">IDOTRR</td>
<td class="gt_row gt_right" headers="n">31</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombre_zona">NoRidge</td>
<td class="gt_row gt_right" headers="n">30</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombre_zona">Timber</td>
<td class="gt_row gt_right" headers="n">26</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombre_zona">ClearCr</td>
<td class="gt_row gt_right" headers="n">22</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombre_zona">StoneBr</td>
<td class="gt_row gt_right" headers="n">20</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombre_zona">SWISU</td>
<td class="gt_row gt_right" headers="n">18</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombre_zona">Blmngtn</td>
<td class="gt_row gt_right" headers="n">14</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombre_zona">BrDale</td>
<td class="gt_row gt_right" headers="n">14</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombre_zona">MeadowV</td>
<td class="gt_row gt_right" headers="n">12</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombre_zona">NPkVill</td>
<td class="gt_row gt_right" headers="n">8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombre_zona">Veenker</td>
<td class="gt_row gt_right" headers="n">7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombre_zona">Blueste</td>
<td class="gt_row gt_right" headers="n">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>En este caso, tenemos muchas categorías, algunas con muy pocos datos, y es posible que observemos nuevos datos. Una técnica es agrupar los datos de baja cardinalidad en un nuevo nivel (incluyendo categorías no observadas en entrenamiento):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>receta_vecindario_1 <span class="ot">&lt;-</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>( <span class="sc">~</span> nombre_zona, casas_entrena) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_other</span>(nombre_zona, <span class="at">threshold =</span> <span class="fl">0.01</span>, <span class="at">other =</span> <span class="st">"otras"</span>) </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>receta_vecindario <span class="ot">&lt;-</span> receta_vecindario_1 <span class="sc">|&gt;</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(nombre_zona)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># preparar receta</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>receta_vecindario_prep <span class="ot">&lt;-</span> <span class="fu">prep</span>(receta_vecindario_1)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8231</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>receta_vecindario_prep <span class="sc">|&gt;</span> <span class="fu">juice</span>() <span class="sc">|&gt;</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(nombre_zona) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="twbalhdbcb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#twbalhdbcb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#twbalhdbcb thead, #twbalhdbcb tbody, #twbalhdbcb tfoot, #twbalhdbcb tr, #twbalhdbcb td, #twbalhdbcb th {
  border-style: none;
}

#twbalhdbcb p {
  margin: 0;
  padding: 0;
}

#twbalhdbcb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#twbalhdbcb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#twbalhdbcb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#twbalhdbcb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#twbalhdbcb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#twbalhdbcb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twbalhdbcb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#twbalhdbcb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#twbalhdbcb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#twbalhdbcb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#twbalhdbcb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#twbalhdbcb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#twbalhdbcb .gt_spanner_row {
  border-bottom-style: hidden;
}

#twbalhdbcb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#twbalhdbcb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#twbalhdbcb .gt_from_md > :first-child {
  margin-top: 0;
}

#twbalhdbcb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#twbalhdbcb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#twbalhdbcb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#twbalhdbcb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#twbalhdbcb .gt_row_group_first td {
  border-top-width: 2px;
}

#twbalhdbcb .gt_row_group_first th {
  border-top-width: 2px;
}

#twbalhdbcb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#twbalhdbcb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#twbalhdbcb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#twbalhdbcb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twbalhdbcb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#twbalhdbcb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#twbalhdbcb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#twbalhdbcb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#twbalhdbcb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twbalhdbcb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#twbalhdbcb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#twbalhdbcb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#twbalhdbcb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#twbalhdbcb .gt_left {
  text-align: left;
}

#twbalhdbcb .gt_center {
  text-align: center;
}

#twbalhdbcb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#twbalhdbcb .gt_font_normal {
  font-weight: normal;
}

#twbalhdbcb .gt_font_bold {
  font-weight: bold;
}

#twbalhdbcb .gt_font_italic {
  font-style: italic;
}

#twbalhdbcb .gt_super {
  font-size: 65%;
}

#twbalhdbcb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#twbalhdbcb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#twbalhdbcb .gt_indent_1 {
  text-indent: 5px;
}

#twbalhdbcb .gt_indent_2 {
  text-indent: 10px;
}

#twbalhdbcb .gt_indent_3 {
  text-indent: 15px;
}

#twbalhdbcb .gt_indent_4 {
  text-indent: 20px;
}

#twbalhdbcb .gt_indent_5 {
  text-indent: 25px;
}

#twbalhdbcb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#twbalhdbcb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="nombre_zona" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">nombre_zona</th>
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="nombre_zona">NAmes</td>
<td class="gt_row gt_right" headers="n">163</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="nombre_zona">CollgCr</td>
<td class="gt_row gt_right" headers="n">113</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="nombre_zona">OldTown</td>
<td class="gt_row gt_right" headers="n">80</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="nombre_zona">Edwards</td>
<td class="gt_row gt_right" headers="n">74</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="nombre_zona">Somerst</td>
<td class="gt_row gt_right" headers="n">65</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="nombre_zona">Gilbert</td>
<td class="gt_row gt_right" headers="n">61</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="nombre_zona">Sawyer</td>
<td class="gt_row gt_right" headers="n">59</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="nombre_zona">NridgHt</td>
<td class="gt_row gt_right" headers="n">58</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="nombre_zona">NWAmes</td>
<td class="gt_row gt_right" headers="n">57</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="nombre_zona">BrkSide</td>
<td class="gt_row gt_right" headers="n">45</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="nombre_zona">SawyerW</td>
<td class="gt_row gt_right" headers="n">42</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="nombre_zona">Crawfor</td>
<td class="gt_row gt_right" headers="n">39</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="nombre_zona">Mitchel</td>
<td class="gt_row gt_right" headers="n">36</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="nombre_zona">IDOTRR</td>
<td class="gt_row gt_right" headers="n">31</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="nombre_zona">NoRidge</td>
<td class="gt_row gt_right" headers="n">30</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="nombre_zona">Timber</td>
<td class="gt_row gt_right" headers="n">26</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="nombre_zona">ClearCr</td>
<td class="gt_row gt_right" headers="n">22</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="nombre_zona">StoneBr</td>
<td class="gt_row gt_right" headers="n">20</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="nombre_zona">SWISU</td>
<td class="gt_row gt_right" headers="n">18</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="nombre_zona">otras</td>
<td class="gt_row gt_right" headers="n">16</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="nombre_zona">Blmngtn</td>
<td class="gt_row gt_right" headers="n">14</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="nombre_zona">BrDale</td>
<td class="gt_row gt_right" headers="n">14</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="nombre_zona">MeadowV</td>
<td class="gt_row gt_right" headers="n">12</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>En este caso, las zonas de baja frecuencia fueron agrupadas en la categoría “otras”. Si observamos un nuevo nivel al momento de predicción:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>prueba_casas <span class="ot">&lt;-</span> <span class="fu">testing</span>(casas_split)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># supongamos que un nuevo nivel aparece</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>prueba_casas<span class="sc">$</span>nombre_zona[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Xochimilco"</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">bake</span>(<span class="fu">prep</span>(receta_vecindario), prueba_casas)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="sc">|&gt;</span>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">tab_options</span>(<span class="at">table.font.size =</span> <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="oygmmnacsl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#oygmmnacsl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#oygmmnacsl thead, #oygmmnacsl tbody, #oygmmnacsl tfoot, #oygmmnacsl tr, #oygmmnacsl td, #oygmmnacsl th {
  border-style: none;
}

#oygmmnacsl p {
  margin: 0;
  padding: 0;
}

#oygmmnacsl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 10px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oygmmnacsl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oygmmnacsl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oygmmnacsl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oygmmnacsl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oygmmnacsl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oygmmnacsl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oygmmnacsl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oygmmnacsl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oygmmnacsl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oygmmnacsl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oygmmnacsl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oygmmnacsl .gt_spanner_row {
  border-bottom-style: hidden;
}

#oygmmnacsl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oygmmnacsl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oygmmnacsl .gt_from_md > :first-child {
  margin-top: 0;
}

#oygmmnacsl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oygmmnacsl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oygmmnacsl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oygmmnacsl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oygmmnacsl .gt_row_group_first td {
  border-top-width: 2px;
}

#oygmmnacsl .gt_row_group_first th {
  border-top-width: 2px;
}

#oygmmnacsl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oygmmnacsl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oygmmnacsl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oygmmnacsl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oygmmnacsl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oygmmnacsl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oygmmnacsl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#oygmmnacsl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oygmmnacsl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oygmmnacsl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oygmmnacsl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oygmmnacsl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oygmmnacsl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oygmmnacsl .gt_left {
  text-align: left;
}

#oygmmnacsl .gt_center {
  text-align: center;
}

#oygmmnacsl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oygmmnacsl .gt_font_normal {
  font-weight: normal;
}

#oygmmnacsl .gt_font_bold {
  font-weight: bold;
}

#oygmmnacsl .gt_font_italic {
  font-style: italic;
}

#oygmmnacsl .gt_super {
  font-size: 65%;
}

#oygmmnacsl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#oygmmnacsl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oygmmnacsl .gt_indent_1 {
  text-indent: 5px;
}

#oygmmnacsl .gt_indent_2 {
  text-indent: 10px;
}

#oygmmnacsl .gt_indent_3 {
  text-indent: 15px;
}

#oygmmnacsl .gt_indent_4 {
  text-indent: 20px;
}

#oygmmnacsl .gt_indent_5 {
  text-indent: 25px;
}

#oygmmnacsl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#oygmmnacsl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="nombre_zona_BrDale" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_BrDale</th>
<th id="nombre_zona_BrkSide" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_BrkSide</th>
<th id="nombre_zona_ClearCr" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_ClearCr</th>
<th id="nombre_zona_CollgCr" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_CollgCr</th>
<th id="nombre_zona_Crawfor" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Crawfor</th>
<th id="nombre_zona_Edwards" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Edwards</th>
<th id="nombre_zona_Gilbert" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Gilbert</th>
<th id="nombre_zona_IDOTRR" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_IDOTRR</th>
<th id="nombre_zona_MeadowV" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_MeadowV</th>
<th id="nombre_zona_Mitchel" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Mitchel</th>
<th id="nombre_zona_NAmes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_NAmes</th>
<th id="nombre_zona_NoRidge" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_NoRidge</th>
<th id="nombre_zona_NridgHt" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_NridgHt</th>
<th id="nombre_zona_NWAmes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_NWAmes</th>
<th id="nombre_zona_OldTown" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_OldTown</th>
<th id="nombre_zona_Sawyer" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Sawyer</th>
<th id="nombre_zona_SawyerW" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_SawyerW</th>
<th id="nombre_zona_Somerst" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Somerst</th>
<th id="nombre_zona_StoneBr" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_StoneBr</th>
<th id="nombre_zona_SWISU" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_SWISU</th>
<th id="nombre_zona_Timber" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Timber</th>
<th id="nombre_zona_otras" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_otras</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="nombre_zona_BrDale">0</td>
<td class="gt_row gt_right" headers="nombre_zona_BrkSide">0</td>
<td class="gt_row gt_right" headers="nombre_zona_ClearCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_CollgCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Gilbert">0</td>
<td class="gt_row gt_right" headers="nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="nombre_zona_MeadowV">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="nombre_zona_StoneBr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SWISU">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="nombre_zona_otras">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="nombre_zona_BrDale">0</td>
<td class="gt_row gt_right" headers="nombre_zona_BrkSide">0</td>
<td class="gt_row gt_right" headers="nombre_zona_ClearCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_CollgCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Gilbert">0</td>
<td class="gt_row gt_right" headers="nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="nombre_zona_MeadowV">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Somerst">1</td>
<td class="gt_row gt_right" headers="nombre_zona_StoneBr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SWISU">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="nombre_zona_otras">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="nombre_zona_BrDale">0</td>
<td class="gt_row gt_right" headers="nombre_zona_BrkSide">0</td>
<td class="gt_row gt_right" headers="nombre_zona_ClearCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_CollgCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Gilbert">0</td>
<td class="gt_row gt_right" headers="nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="nombre_zona_MeadowV">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Sawyer">1</td>
<td class="gt_row gt_right" headers="nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="nombre_zona_StoneBr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SWISU">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="nombre_zona_otras">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="nombre_zona_BrDale">0</td>
<td class="gt_row gt_right" headers="nombre_zona_BrkSide">0</td>
<td class="gt_row gt_right" headers="nombre_zona_ClearCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_CollgCr">1</td>
<td class="gt_row gt_right" headers="nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Gilbert">0</td>
<td class="gt_row gt_right" headers="nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="nombre_zona_MeadowV">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="nombre_zona_StoneBr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SWISU">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="nombre_zona_otras">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="nombre_zona_BrDale">0</td>
<td class="gt_row gt_right" headers="nombre_zona_BrkSide">0</td>
<td class="gt_row gt_right" headers="nombre_zona_ClearCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_CollgCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Gilbert">0</td>
<td class="gt_row gt_right" headers="nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="nombre_zona_MeadowV">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NAmes">1</td>
<td class="gt_row gt_right" headers="nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="nombre_zona_StoneBr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SWISU">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="nombre_zona_otras">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="nombre_zona_BrDale">0</td>
<td class="gt_row gt_right" headers="nombre_zona_BrkSide">0</td>
<td class="gt_row gt_right" headers="nombre_zona_ClearCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_CollgCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Gilbert">0</td>
<td class="gt_row gt_right" headers="nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="nombre_zona_MeadowV">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NAmes">1</td>
<td class="gt_row gt_right" headers="nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="nombre_zona_StoneBr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SWISU">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="nombre_zona_otras">0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>El proceso general es (ver por ejemplo <a href="https://recipes.tidymodels.org/articles/Ordering.html">esta lista</a>):</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Variables categóricas
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Establecemos los niveles que puede tener cada variable, incluyendo la posibilidad de categorías nuevas al momento de predecir, y categorías para valores no disponibles (NAs) (es posible también imputar con algún método en caso necesario).</li>
<li>Reorganizamos factores dependiendo del problema. Por ejemplo, incluir categorías de baja frecuencia en una categoría separada, o manipulaciones ad-hoc dependiendo del problema.</li>
<li>Sustituimos variables categóricas con <span class="math inline">\(K\)</span> niveles en <span class="math inline">\(K-1\)</span> columnas indicadoras de los niveles (estableciendo) alguna categoría como referencia. Esto no es estrictamente necesario en otros métodos, o si utilizamos regularización (ver sección siguiente).</li>
</ol>
</div>
</div>
</section>
<section id="interacciones" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="interacciones"><span class="header-section-number">4.4</span> Interacciones</h2>
<p>Otra manera de expandir nuestro modelo es la utilización de interacciones, que muchas veces son clave para tener éxito con modelos lineales. Vimos ejemplos de interacciones en el ejemplo de las casas (<a href="01-introduccion.html#sec-medicioncostosa" class="quarto-xref"><span>Sección 1.3</span></a>) y en el primer ejemplo de ventas de tiendas que dependían del tráfico.</p>
<section id="ejemplo" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="ejemplo">Ejemplo</h3>
<p>Si <span class="math inline">\(x_1\)</span> es el área en metros cuadrados de una casa, y <span class="math inline">\(x_2\)</span> una calificación numérica de su calidad, podemos considerar el modelo sin interacciones:</p>
<p><span class="math display">\[\beta_0 + \beta_1x_1 + \beta_2 x_2\]</span></p>
<p>Pero no tiene mucho sentido que el efecto marginal de <span class="math inline">\(x_1\)</span> sea constante para cualquier nivel de calidad, y tampoco que la calidad de terminados agregue una cantidad fija al precio de la casa sin tomar en cuenta su tamaño. Podemos remediar esto creando una nueva variable que es le producto de <span class="math inline">\(x_1\)</span> y <span class="math inline">\(x_2\)</span>:</p>
<p><span class="math display">\[x_3 = x_1 x_2\]</span></p>
<p>y agregando, nuestro predictor para precio es</p>
<p><span class="math display">\[ \beta_0 +  \beta_1x_1 + \beta_2 x_2 + \beta_3 x_1x_2\]</span></p>
<p>Ahora notemos que para <span class="math inline">\(x_2\)</span> fija, el modelo es</p>
<p><span class="math display">\[(\beta_0 + \beta_2x_2) + (\beta_1 + \beta_3x_2)x_1 = \gamma_0 + \gamma_1x_1\]</span> De modo que es lineal en <span class="math inline">\(x_1\)</span>. La diferencia es que cuando cambia <span class="math inline">\(x_2\)</span>, la recta que ajustamos es diferente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">20</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>combs_tbl <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">x_1 =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="at">x_2 =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x_3 =</span> x_1 <span class="sc">*</span> x_2) <span class="sc">|&gt;</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred =</span> beta[<span class="dv">1</span>] <span class="sc">+</span> beta[<span class="dv">2</span>]<span class="sc">*</span>x_1 <span class="sc">+</span> beta[<span class="dv">3</span>]<span class="sc">*</span>x_2 <span class="sc">+</span> beta[<span class="dv">4</span>]<span class="sc">*</span>x_3)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combs_tbl, <span class="fu">aes</span>(<span class="at">x =</span> x_1, <span class="at">y =</span> pred, <span class="at">group =</span> x_2, <span class="at">colour =</span> x_2)) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-lineales-ingenieria_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>Y vemos que cuando la calidad es baja, el precio por metro cuadrado es más bajo que cuando la calidad es alta. Otra manera de pensar esto es que la inclusión de la interacción produce curvas marginales que <em>rotan</em> dependiendo del valor de otras variables.</p>
<p><strong>Pregunta</strong>. ¿puedes pensar en otros casos donde las interacciones deben jugar un papel importante?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Interacciones
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Transformamos las variables categóricas a dummies. Transformamos las variables numéricas si es necesario (normalizar, aplicar transformación no lineal, etc.)</li>
<li>Incluimos interacciones de la siguiente forma:</li>
</ol>
<ul>
<li>Para la interaccion de dos variables numéricas <span class="math inline">\(x_1\)</span> y <span class="math inline">\(x_2\)</span> agregamos el producto <span class="math inline">\(x_3 = x_1x_2\)</span>.</li>
<li>Para interacción de una variable categórica <span class="math inline">\(g\)</span> con una numérica <span class="math inline">\(x\)</span> podemos hacer el mismo procedimiento multiplicando la variable categórica por cada una de las variable dummy que creamos a partir de <span class="math inline">\(g\)</span>. Esto en efecto produce una pendiente para <span class="math inline">\(x\)</span> dependiendo del valor que toma <span class="math inline">\(g\)</span>.</li>
</ul>
</div>
</div>
</section>
</section>
<section id="ejemplo-precios-de-casas" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="ejemplo-precios-de-casas"><span class="header-section-number">4.5</span> Ejemplo: precios de casas</h2>
<p>En el ejemplo de precios de casas, por ejemplo, es claro que el efecto en ventas del tamaño de las áreas (habitable, garage, etc.) depende de la calidad de los terminados, como vimos en la introducción. En la siguiente receta de preprocesamiento:</p>
<ul>
<li>Cortamos calidad general en 5 grupos: este paso no es necesario y puede dañar el desempeño, pero es consistente con el análisis que hicimos anteriormente.</li>
<li>Lidiamos con niveles nuevos y los ponemos en una categoría “nuevo” (para que nuestro modelo no falle al momento de predicción)</li>
<li>Ponemos los faltantes de calidad sotano y garage en una categoría nueva (no tienen sótano y/o garage)</li>
<li>Agrupamos las zonas con pocas observaciones en una categoría de “Otros”</li>
<li>Quitamos los NA’s de área garage y área sotano, que deben ser igual a 0 cuando no existen estas características.</li>
<li>Creamos variables dummy de todas las variables categóricas</li>
<li>Incluimos interacciones de distintas áreas con las dummy correspondientes, incluyendo zona con área habitable</li>
<li>Finalmente, eliminamos para el ajuste aquellas variables que tengan varianza cercana a cero (500 /1 quiere decir que elimina cualquier variable cuyo conteo del valor más común entre el conteo de la siguiente es mayor a 500).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../R/casas_traducir_geo.R"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">83</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>casas_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(casas, <span class="at">prop =</span> <span class="fl">0.75</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>casas_entrena <span class="ot">&lt;-</span> <span class="fu">training</span>(casas_split)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>receta_casas <span class="ot">&lt;-</span> <span class="fu">recipe</span>(precio_miles <span class="sc">~</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>           nombre_zona <span class="sc">+</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>           area_hab_m2 <span class="sc">+</span> area_garage_m2 <span class="sc">+</span> area_sotano_m2 <span class="sc">+</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>           area_lote_m2 <span class="sc">+</span> </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>           año_construccion <span class="sc">+</span> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>           calidad_gral <span class="sc">+</span> calidad_garage <span class="sc">+</span> calidad_sotano <span class="sc">+</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>           num_coches  <span class="sc">+</span> </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>           aire_acondicionado <span class="sc">+</span> condicion_venta, </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> casas_entrena) <span class="sc">|&gt;</span> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_filter</span>(condicion_venta <span class="sc">==</span> <span class="st">"Normal"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_select</span>(<span class="sc">-</span>condicion_venta, <span class="at">skip =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_cut</span>(calidad_gral, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">8</span>), </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">include_outside_range =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_novel</span>(nombre_zona, calidad_sotano, calidad_garage) <span class="sc">|&gt;</span> </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(calidad_sotano, calidad_garage) <span class="sc">|&gt;</span> </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_other</span>(nombre_zona, <span class="at">threshold =</span> <span class="fl">0.02</span>, <span class="at">other =</span> <span class="st">"otras"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">area_sotano_m2 =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(area_sotano_m2), <span class="dv">0</span>, area_sotano_m2)) <span class="sc">|&gt;</span> </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">area_garage_m2 =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(area_garage_m2), <span class="dv">0</span>, area_garage_m2)) <span class="sc">|&gt;</span> </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(nombre_zona, calidad_gral, calidad_garage, calidad_sotano, aire_acondicionado) <span class="sc">|&gt;</span> </span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> area_hab_m2<span class="sc">:</span><span class="fu">starts_with</span>(<span class="st">"calidad_gral"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> area_hab_m2<span class="sc">:</span><span class="fu">starts_with</span>(<span class="st">"nombre_zona"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> area_garage_m2<span class="sc">:</span><span class="fu">starts_with</span>(<span class="st">"calidad_garage"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> area_sotano_m2<span class="sc">:</span> <span class="fu">starts_with</span>(<span class="st">"calidad_sotano"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_nzv</span>(<span class="fu">all_predictors</span>(), <span class="at">freq_cut =</span> <span class="dv">500</span> <span class="sc">/</span> <span class="dv">1</span>, <span class="at">unique_cut =</span> <span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Entrenamos la receta y vemos cuántos casos y columnas tenemos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>receta_casas_prep <span class="ot">&lt;-</span> <span class="fu">prep</span>(receta_casas, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>oper 1 step filter [training] 
oper 2 step select [training] 
oper 3 step cut [training] 
oper 4 step novel [training] 
oper 5 step unknown [training] 
oper 6 step other [training] 
oper 7 step mutate [training] 
oper 8 step mutate [training] 
oper 9 step dummy [training] 
oper 10 step interact [training] 
oper 11 step interact [training] 
oper 12 step interact [training] 
oper 13 step interact [training] 
oper 14 step nzv [training] 
The retained training set is ~ 0.44 Mb  in memory.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>datos_tbl <span class="ot">&lt;-</span> <span class="fu">juice</span>(receta_casas_prep)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(datos_tbl)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 907  62</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>datos_tbl <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), \(x) <span class="fu">round</span>(x, <span class="dv">2</span>))) <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="vanbquvomk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vanbquvomk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vanbquvomk thead, #vanbquvomk tbody, #vanbquvomk tfoot, #vanbquvomk tr, #vanbquvomk td, #vanbquvomk th {
  border-style: none;
}

#vanbquvomk p {
  margin: 0;
  padding: 0;
}

#vanbquvomk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vanbquvomk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vanbquvomk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vanbquvomk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vanbquvomk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vanbquvomk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vanbquvomk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vanbquvomk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vanbquvomk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vanbquvomk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vanbquvomk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vanbquvomk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vanbquvomk .gt_spanner_row {
  border-bottom-style: hidden;
}

#vanbquvomk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vanbquvomk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vanbquvomk .gt_from_md > :first-child {
  margin-top: 0;
}

#vanbquvomk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vanbquvomk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vanbquvomk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vanbquvomk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vanbquvomk .gt_row_group_first td {
  border-top-width: 2px;
}

#vanbquvomk .gt_row_group_first th {
  border-top-width: 2px;
}

#vanbquvomk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vanbquvomk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vanbquvomk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vanbquvomk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vanbquvomk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vanbquvomk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vanbquvomk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vanbquvomk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vanbquvomk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vanbquvomk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vanbquvomk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vanbquvomk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vanbquvomk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vanbquvomk .gt_left {
  text-align: left;
}

#vanbquvomk .gt_center {
  text-align: center;
}

#vanbquvomk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vanbquvomk .gt_font_normal {
  font-weight: normal;
}

#vanbquvomk .gt_font_bold {
  font-weight: bold;
}

#vanbquvomk .gt_font_italic {
  font-style: italic;
}

#vanbquvomk .gt_super {
  font-size: 65%;
}

#vanbquvomk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vanbquvomk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vanbquvomk .gt_indent_1 {
  text-indent: 5px;
}

#vanbquvomk .gt_indent_2 {
  text-indent: 10px;
}

#vanbquvomk .gt_indent_3 {
  text-indent: 15px;
}

#vanbquvomk .gt_indent_4 {
  text-indent: 20px;
}

#vanbquvomk .gt_indent_5 {
  text-indent: 25px;
}

#vanbquvomk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vanbquvomk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="area_hab_m2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2</th>
<th id="area_garage_m2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_garage_m2</th>
<th id="area_sotano_m2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_sotano_m2</th>
<th id="area_lote_m2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_lote_m2</th>
<th id="año_construccion" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">año_construccion</th>
<th id="num_coches" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">num_coches</th>
<th id="precio_miles" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">precio_miles</th>
<th id="nombre_zona_CollgCr" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_CollgCr</th>
<th id="nombre_zona_Crawfor" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Crawfor</th>
<th id="nombre_zona_Edwards" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Edwards</th>
<th id="nombre_zona_Gilbert" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Gilbert</th>
<th id="nombre_zona_IDOTRR" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_IDOTRR</th>
<th id="nombre_zona_Mitchel" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Mitchel</th>
<th id="nombre_zona_NAmes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_NAmes</th>
<th id="nombre_zona_NoRidge" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_NoRidge</th>
<th id="nombre_zona_NridgHt" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_NridgHt</th>
<th id="nombre_zona_NWAmes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_NWAmes</th>
<th id="nombre_zona_OldTown" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_OldTown</th>
<th id="nombre_zona_Sawyer" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Sawyer</th>
<th id="nombre_zona_SawyerW" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_SawyerW</th>
<th id="nombre_zona_Somerst" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Somerst</th>
<th id="nombre_zona_Timber" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_Timber</th>
<th id="nombre_zona_otras" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">nombre_zona_otras</th>
<th id="calidad_gral_X.3.5." class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_gral_X.3.5.</th>
<th id="calidad_gral_X.5.7." class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_gral_X.5.7.</th>
<th id="calidad_gral_X.7.8." class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_gral_X.7.8.</th>
<th id="calidad_gral_X.8.max." class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_gral_X.8.max.</th>
<th id="calidad_garage_Fa" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_garage_Fa</th>
<th id="calidad_garage_Gd" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_garage_Gd</th>
<th id="calidad_garage_TA" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_garage_TA</th>
<th id="calidad_garage_unknown" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_garage_unknown</th>
<th id="calidad_sotano_Fa" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_sotano_Fa</th>
<th id="calidad_sotano_Gd" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_sotano_Gd</th>
<th id="calidad_sotano_TA" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_sotano_TA</th>
<th id="calidad_sotano_unknown" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">calidad_sotano_unknown</th>
<th id="aire_acondicionado_Y" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">aire_acondicionado_Y</th>
<th id="area_hab_m2_x_calidad_gral_X.3.5." class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_calidad_gral_X.3.5.</th>
<th id="area_hab_m2_x_calidad_gral_X.5.7." class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_calidad_gral_X.5.7.</th>
<th id="area_hab_m2_x_calidad_gral_X.7.8." class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_calidad_gral_X.7.8.</th>
<th id="area_hab_m2_x_calidad_gral_X.8.max." class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_calidad_gral_X.8.max.</th>
<th id="area_hab_m2_x_nombre_zona_CollgCr" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_CollgCr</th>
<th id="area_hab_m2_x_nombre_zona_Crawfor" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_Crawfor</th>
<th id="area_hab_m2_x_nombre_zona_Edwards" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_Edwards</th>
<th id="area_hab_m2_x_nombre_zona_Gilbert" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_Gilbert</th>
<th id="area_hab_m2_x_nombre_zona_IDOTRR" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_IDOTRR</th>
<th id="area_hab_m2_x_nombre_zona_Mitchel" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_Mitchel</th>
<th id="area_hab_m2_x_nombre_zona_NAmes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_NAmes</th>
<th id="area_hab_m2_x_nombre_zona_NoRidge" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_NoRidge</th>
<th id="area_hab_m2_x_nombre_zona_NridgHt" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_NridgHt</th>
<th id="area_hab_m2_x_nombre_zona_NWAmes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_NWAmes</th>
<th id="area_hab_m2_x_nombre_zona_OldTown" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_OldTown</th>
<th id="area_hab_m2_x_nombre_zona_Sawyer" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_Sawyer</th>
<th id="area_hab_m2_x_nombre_zona_SawyerW" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_SawyerW</th>
<th id="area_hab_m2_x_nombre_zona_Somerst" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_Somerst</th>
<th id="area_hab_m2_x_nombre_zona_Timber" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_Timber</th>
<th id="area_hab_m2_x_nombre_zona_otras" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_hab_m2_x_nombre_zona_otras</th>
<th id="area_garage_m2_x_calidad_garage_Fa" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_garage_m2_x_calidad_garage_Fa</th>
<th id="area_garage_m2_x_calidad_garage_Gd" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_garage_m2_x_calidad_garage_Gd</th>
<th id="area_garage_m2_x_calidad_garage_TA" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_garage_m2_x_calidad_garage_TA</th>
<th id="area_sotano_m2_x_calidad_sotano_Fa" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_sotano_m2_x_calidad_sotano_Fa</th>
<th id="area_sotano_m2_x_calidad_sotano_Gd" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_sotano_m2_x_calidad_sotano_Gd</th>
<th id="area_sotano_m2_x_calidad_sotano_TA" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">area_sotano_m2_x_calidad_sotano_TA</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="area_hab_m2">137.22</td>
<td class="gt_row gt_right" headers="area_garage_m2">20.07</td>
<td class="gt_row gt_right" headers="area_sotano_m2">79.99</td>
<td class="gt_row gt_right" headers="area_lote_m2">584.55</td>
<td class="gt_row gt_right" headers="año_construccion">1928</td>
<td class="gt_row gt_right" headers="num_coches">1</td>
<td class="gt_row gt_right" headers="precio_miles">145.0</td>
<td class="gt_row gt_right" headers="nombre_zona_CollgCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Gilbert">0</td>
<td class="gt_row gt_right" headers="nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="nombre_zona_otras">1</td>
<td class="gt_row gt_right" headers="calidad_gral_X.3.5.">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.5.7.">1</td>
<td class="gt_row gt_right" headers="calidad_gral_X.7.8.">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.8.max.">0</td>
<td class="gt_row gt_right" headers="calidad_garage_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_garage_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_garage_TA">1</td>
<td class="gt_row gt_right" headers="calidad_garage_unknown">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_TA">1</td>
<td class="gt_row gt_right" headers="calidad_sotano_unknown">0</td>
<td class="gt_row gt_right" headers="aire_acondicionado_Y">1</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.3.5.">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.5.7.">137.22</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.7.8.">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.8.max.">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_CollgCr">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Gilbert">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NAmes">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_otras">137.22</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_Fa">0</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_Gd">0</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_TA">20.07</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_Gd">0.00</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_TA">79.99</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="area_hab_m2">179.86</td>
<td class="gt_row gt_right" headers="area_garage_m2">46.82</td>
<td class="gt_row gt_right" headers="area_sotano_m2">130.62</td>
<td class="gt_row gt_right" headers="area_lote_m2">1039.96</td>
<td class="gt_row gt_right" headers="año_construccion">2000</td>
<td class="gt_row gt_right" headers="num_coches">2</td>
<td class="gt_row gt_right" headers="precio_miles">230.5</td>
<td class="gt_row gt_right" headers="nombre_zona_CollgCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Gilbert">1</td>
<td class="gt_row gt_right" headers="nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="nombre_zona_otras">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.3.5.">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.5.7.">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.7.8.">1</td>
<td class="gt_row gt_right" headers="calidad_gral_X.8.max.">0</td>
<td class="gt_row gt_right" headers="calidad_garage_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_garage_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_garage_TA">1</td>
<td class="gt_row gt_right" headers="calidad_garage_unknown">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">1</td>
<td class="gt_row gt_right" headers="calidad_sotano_TA">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_unknown">0</td>
<td class="gt_row gt_right" headers="aire_acondicionado_Y">1</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.3.5.">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.5.7.">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.7.8.">179.86</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.8.max.">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_CollgCr">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Gilbert">179.86</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NAmes">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_otras">0.00</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_Fa">0</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_Gd">0</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_TA">46.82</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_Gd">130.62</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_TA">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="area_hab_m2">81.94</td>
<td class="gt_row gt_right" headers="area_garage_m2">27.31</td>
<td class="gt_row gt_right" headers="area_sotano_m2">0.00</td>
<td class="gt_row gt_right" headers="area_lote_m2">774.72</td>
<td class="gt_row gt_right" headers="año_construccion">1959</td>
<td class="gt_row gt_right" headers="num_coches">1</td>
<td class="gt_row gt_right" headers="precio_miles">106.5</td>
<td class="gt_row gt_right" headers="nombre_zona_CollgCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Gilbert">0</td>
<td class="gt_row gt_right" headers="nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NAmes">1</td>
<td class="gt_row gt_right" headers="nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="nombre_zona_otras">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.3.5.">1</td>
<td class="gt_row gt_right" headers="calidad_gral_X.5.7.">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.7.8.">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.8.max.">0</td>
<td class="gt_row gt_right" headers="calidad_garage_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_garage_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_garage_TA">1</td>
<td class="gt_row gt_right" headers="calidad_garage_unknown">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_TA">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_unknown">1</td>
<td class="gt_row gt_right" headers="aire_acondicionado_Y">1</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.3.5.">81.94</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.5.7.">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.7.8.">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.8.max.">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_CollgCr">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Gilbert">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NAmes">81.94</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_otras">0.00</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_Fa">0</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_Gd">0</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_TA">27.31</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_Gd">0.00</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_TA">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="area_hab_m2">153.01</td>
<td class="gt_row gt_right" headers="area_garage_m2">20.07</td>
<td class="gt_row gt_right" headers="area_sotano_m2">74.88</td>
<td class="gt_row gt_right" headers="area_lote_m2">637.13</td>
<td class="gt_row gt_right" headers="año_construccion">1915</td>
<td class="gt_row gt_right" headers="num_coches">1</td>
<td class="gt_row gt_right" headers="precio_miles">128.0</td>
<td class="gt_row gt_right" headers="nombre_zona_CollgCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Gilbert">0</td>
<td class="gt_row gt_right" headers="nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="nombre_zona_otras">1</td>
<td class="gt_row gt_right" headers="calidad_gral_X.3.5.">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.5.7.">1</td>
<td class="gt_row gt_right" headers="calidad_gral_X.7.8.">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.8.max.">0</td>
<td class="gt_row gt_right" headers="calidad_garage_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_garage_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_garage_TA">1</td>
<td class="gt_row gt_right" headers="calidad_garage_unknown">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">1</td>
<td class="gt_row gt_right" headers="calidad_sotano_TA">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_unknown">0</td>
<td class="gt_row gt_right" headers="aire_acondicionado_Y">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.3.5.">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.5.7.">153.01</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.7.8.">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.8.max.">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_CollgCr">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Gilbert">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NAmes">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_otras">153.01</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_Fa">0</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_Gd">0</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_TA">20.07</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_Gd">74.88</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_TA">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="area_hab_m2">101.45</td>
<td class="gt_row gt_right" headers="area_garage_m2">26.57</td>
<td class="gt_row gt_right" headers="area_sotano_m2">50.73</td>
<td class="gt_row gt_right" headers="area_lote_m2">205.97</td>
<td class="gt_row gt_right" headers="año_construccion">1970</td>
<td class="gt_row gt_right" headers="num_coches">1</td>
<td class="gt_row gt_right" headers="precio_miles">88.0</td>
<td class="gt_row gt_right" headers="nombre_zona_CollgCr">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Gilbert">0</td>
<td class="gt_row gt_right" headers="nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="nombre_zona_otras">1</td>
<td class="gt_row gt_right" headers="calidad_gral_X.3.5.">1</td>
<td class="gt_row gt_right" headers="calidad_gral_X.5.7.">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.7.8.">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.8.max.">0</td>
<td class="gt_row gt_right" headers="calidad_garage_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_garage_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_garage_TA">1</td>
<td class="gt_row gt_right" headers="calidad_garage_unknown">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_TA">1</td>
<td class="gt_row gt_right" headers="calidad_sotano_unknown">0</td>
<td class="gt_row gt_right" headers="aire_acondicionado_Y">1</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.3.5.">101.45</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.5.7.">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.7.8.">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.8.max.">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_CollgCr">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Gilbert">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NAmes">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_otras">101.45</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_Fa">0</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_Gd">0</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_TA">26.57</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_Gd">0.00</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_TA">50.73</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="area_hab_m2">71.35</td>
<td class="gt_row gt_right" headers="area_garage_m2">36.79</td>
<td class="gt_row gt_right" headers="area_sotano_m2">71.35</td>
<td class="gt_row gt_right" headers="area_lote_m2">668.90</td>
<td class="gt_row gt_right" headers="año_construccion">1972</td>
<td class="gt_row gt_right" headers="num_coches">1</td>
<td class="gt_row gt_right" headers="precio_miles">133.9</td>
<td class="gt_row gt_right" headers="nombre_zona_CollgCr">1</td>
<td class="gt_row gt_right" headers="nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Gilbert">0</td>
<td class="gt_row gt_right" headers="nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="nombre_zona_otras">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.3.5.">1</td>
<td class="gt_row gt_right" headers="calidad_gral_X.5.7.">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.7.8.">0</td>
<td class="gt_row gt_right" headers="calidad_gral_X.8.max.">0</td>
<td class="gt_row gt_right" headers="calidad_garage_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_garage_Gd">0</td>
<td class="gt_row gt_right" headers="calidad_garage_TA">1</td>
<td class="gt_row gt_right" headers="calidad_garage_unknown">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_Gd">1</td>
<td class="gt_row gt_right" headers="calidad_sotano_TA">0</td>
<td class="gt_row gt_right" headers="calidad_sotano_unknown">0</td>
<td class="gt_row gt_right" headers="aire_acondicionado_Y">1</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.3.5.">71.35</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.5.7.">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.7.8.">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_calidad_gral_X.8.max.">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_CollgCr">71.35</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Crawfor">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Edwards">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Gilbert">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_IDOTRR">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Mitchel">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NAmes">0.00</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NoRidge">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NridgHt">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_NWAmes">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_OldTown">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Sawyer">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_SawyerW">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Somerst">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_Timber">0</td>
<td class="gt_row gt_right" headers="area_hab_m2_x_nombre_zona_otras">0.00</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_Fa">0</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_Gd">0</td>
<td class="gt_row gt_right" headers="area_garage_m2_x_calidad_garage_TA">36.79</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_Fa">0</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_Gd">71.35</td>
<td class="gt_row gt_right" headers="area_sotano_m2_x_calidad_sotano_TA">0.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Finalmente, usamos un modelo lineal con las 62 entradas que acabamos de crear:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>flujo_casas <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(receta_casas) <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(<span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"lm"</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>ajuste <span class="ot">&lt;-</span> <span class="fu">fit</span>(flujo_casas, casas_entrena)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Aunque no es de interés particular para nosotros por el momento, examinamos los coeficientes (que no son tan simples de interpretar como discutiremos más adelante):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ajuste <span class="sc">|&gt;</span> broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), \(x) <span class="fu">round</span>(x, <span class="dv">2</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate) <span class="sc">|&gt;</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="wjpynotfka" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wjpynotfka table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wjpynotfka thead, #wjpynotfka tbody, #wjpynotfka tfoot, #wjpynotfka tr, #wjpynotfka td, #wjpynotfka th {
  border-style: none;
}

#wjpynotfka p {
  margin: 0;
  padding: 0;
}

#wjpynotfka .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wjpynotfka .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wjpynotfka .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wjpynotfka .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wjpynotfka .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wjpynotfka .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wjpynotfka .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wjpynotfka .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wjpynotfka .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wjpynotfka .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wjpynotfka .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wjpynotfka .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wjpynotfka .gt_spanner_row {
  border-bottom-style: hidden;
}

#wjpynotfka .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wjpynotfka .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wjpynotfka .gt_from_md > :first-child {
  margin-top: 0;
}

#wjpynotfka .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wjpynotfka .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wjpynotfka .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wjpynotfka .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wjpynotfka .gt_row_group_first td {
  border-top-width: 2px;
}

#wjpynotfka .gt_row_group_first th {
  border-top-width: 2px;
}

#wjpynotfka .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wjpynotfka .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wjpynotfka .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wjpynotfka .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wjpynotfka .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wjpynotfka .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wjpynotfka .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wjpynotfka .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wjpynotfka .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wjpynotfka .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wjpynotfka .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wjpynotfka .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wjpynotfka .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wjpynotfka .gt_left {
  text-align: left;
}

#wjpynotfka .gt_center {
  text-align: center;
}

#wjpynotfka .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wjpynotfka .gt_font_normal {
  font-weight: normal;
}

#wjpynotfka .gt_font_bold {
  font-weight: bold;
}

#wjpynotfka .gt_font_italic {
  font-style: italic;
}

#wjpynotfka .gt_super {
  font-size: 65%;
}

#wjpynotfka .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wjpynotfka .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wjpynotfka .gt_indent_1 {
  text-indent: 5px;
}

#wjpynotfka .gt_indent_2 {
  text-indent: 10px;
}

#wjpynotfka .gt_indent_3 {
  text-indent: 15px;
}

#wjpynotfka .gt_indent_4 {
  text-indent: 20px;
}

#wjpynotfka .gt_indent_5 {
  text-indent: 25px;
}

#wjpynotfka .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wjpynotfka div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="term" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">term</th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">estimate</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="term">(Intercept)</td>
<td class="gt_row gt_right" headers="estimate">-858.68</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_hab_m2</td>
<td class="gt_row gt_right" headers="estimate">0.80</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_garage_m2</td>
<td class="gt_row gt_right" headers="estimate">1.02</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_sotano_m2</td>
<td class="gt_row gt_right" headers="estimate">0.88</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_lote_m2</td>
<td class="gt_row gt_right" headers="estimate">0.01</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">año_construccion</td>
<td class="gt_row gt_right" headers="estimate">0.39</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">num_coches</td>
<td class="gt_row gt_right" headers="estimate">2.11</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">nombre_zona_CollgCr</td>
<td class="gt_row gt_right" headers="estimate">16.70</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">nombre_zona_Crawfor</td>
<td class="gt_row gt_right" headers="estimate">37.11</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">nombre_zona_Edwards</td>
<td class="gt_row gt_right" headers="estimate">28.82</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">nombre_zona_Gilbert</td>
<td class="gt_row gt_right" headers="estimate">31.31</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">nombre_zona_IDOTRR</td>
<td class="gt_row gt_right" headers="estimate">11.81</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">nombre_zona_Mitchel</td>
<td class="gt_row gt_right" headers="estimate">32.01</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">nombre_zona_NAmes</td>
<td class="gt_row gt_right" headers="estimate">28.74</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">nombre_zona_NoRidge</td>
<td class="gt_row gt_right" headers="estimate">22.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">nombre_zona_NridgHt</td>
<td class="gt_row gt_right" headers="estimate">-6.51</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">nombre_zona_NWAmes</td>
<td class="gt_row gt_right" headers="estimate">17.67</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">nombre_zona_OldTown</td>
<td class="gt_row gt_right" headers="estimate">25.28</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">nombre_zona_Sawyer</td>
<td class="gt_row gt_right" headers="estimate">37.91</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">nombre_zona_SawyerW</td>
<td class="gt_row gt_right" headers="estimate">-11.95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">nombre_zona_Somerst</td>
<td class="gt_row gt_right" headers="estimate">-8.99</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">nombre_zona_Timber</td>
<td class="gt_row gt_right" headers="estimate">3.23</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">nombre_zona_otras</td>
<td class="gt_row gt_right" headers="estimate">-14.27</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">calidad_gral_X.3.5.</td>
<td class="gt_row gt_right" headers="estimate">35.54</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">calidad_gral_X.5.7.</td>
<td class="gt_row gt_right" headers="estimate">13.76</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">calidad_gral_X.7.8.</td>
<td class="gt_row gt_right" headers="estimate">16.99</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">calidad_gral_X.8.max.</td>
<td class="gt_row gt_right" headers="estimate">-67.26</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">calidad_garage_Fa</td>
<td class="gt_row gt_right" headers="estimate">15.54</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">calidad_garage_Gd</td>
<td class="gt_row gt_right" headers="estimate">39.04</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">calidad_garage_TA</td>
<td class="gt_row gt_right" headers="estimate">18.71</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">calidad_garage_unknown</td>
<td class="gt_row gt_right" headers="estimate">20.61</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">calidad_sotano_Fa</td>
<td class="gt_row gt_right" headers="estimate">72.92</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">calidad_sotano_Gd</td>
<td class="gt_row gt_right" headers="estimate">54.95</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">calidad_sotano_TA</td>
<td class="gt_row gt_right" headers="estimate">60.56</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">calidad_sotano_unknown</td>
<td class="gt_row gt_right" headers="estimate">59.88</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">aire_acondicionado_Y</td>
<td class="gt_row gt_right" headers="estimate">15.17</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_calidad_gral_X.3.5.</td>
<td class="gt_row gt_right" headers="estimate">-0.25</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_calidad_gral_X.5.7.</td>
<td class="gt_row gt_right" headers="estimate">0.05</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_calidad_gral_X.7.8.</td>
<td class="gt_row gt_right" headers="estimate">0.19</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_calidad_gral_X.8.max.</td>
<td class="gt_row gt_right" headers="estimate">0.81</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_CollgCr</td>
<td class="gt_row gt_right" headers="estimate">-0.25</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_Crawfor</td>
<td class="gt_row gt_right" headers="estimate">-0.14</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_Edwards</td>
<td class="gt_row gt_right" headers="estimate">-0.39</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_Gilbert</td>
<td class="gt_row gt_right" headers="estimate">-0.33</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_IDOTRR</td>
<td class="gt_row gt_right" headers="estimate">-0.21</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_Mitchel</td>
<td class="gt_row gt_right" headers="estimate">-0.42</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_NAmes</td>
<td class="gt_row gt_right" headers="estimate">-0.31</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_NoRidge</td>
<td class="gt_row gt_right" headers="estimate">-0.16</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_NridgHt</td>
<td class="gt_row gt_right" headers="estimate">-0.03</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_NWAmes</td>
<td class="gt_row gt_right" headers="estimate">-0.26</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_OldTown</td>
<td class="gt_row gt_right" headers="estimate">-0.32</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_Sawyer</td>
<td class="gt_row gt_right" headers="estimate">-0.43</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_SawyerW</td>
<td class="gt_row gt_right" headers="estimate">-0.07</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_Somerst</td>
<td class="gt_row gt_right" headers="estimate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_Timber</td>
<td class="gt_row gt_right" headers="estimate">-0.14</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_hab_m2_x_nombre_zona_otras</td>
<td class="gt_row gt_right" headers="estimate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_garage_m2_x_calidad_garage_Fa</td>
<td class="gt_row gt_right" headers="estimate">-0.59</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_garage_m2_x_calidad_garage_Gd</td>
<td class="gt_row gt_right" headers="estimate">-0.97</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_garage_m2_x_calidad_garage_TA</td>
<td class="gt_row gt_right" headers="estimate">-0.78</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_sotano_m2_x_calidad_sotano_Fa</td>
<td class="gt_row gt_right" headers="estimate">-0.86</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">area_sotano_m2_x_calidad_sotano_Gd</td>
<td class="gt_row gt_right" headers="estimate">-0.53</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">area_sotano_m2_x_calidad_sotano_TA</td>
<td class="gt_row gt_right" headers="estimate">-0.67</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Nótese que:</p>
<ul>
<li>En esta tabla están los coeficientes <span class="math inline">\(\beta_i\)</span> en las covariables que creamos a partir de las variables de entrada.</li>
<li>El modelo lineal <em>no</em> tiene que ser lineal <em>en las variables que recibimos originalmente en la tabla de datos</em>.</li>
<li>En este ejemplo, convertimos algunas variables a <em>dummy</em>, y multiplicamos algunas variables de área por esas variables dummy.</li>
</ul>
<p>Finalmente, evaluamos el desempeño sobre las ventas normales:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>metricas <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(mape, mae, rmse, rsq)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>casas_prueba_normal <span class="ot">&lt;-</span> <span class="fu">testing</span>(casas_split) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(condicion_venta <span class="sc">==</span> <span class="st">"Normal"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metricas</span>(casas_prueba_normal <span class="sc">|&gt;</span> <span class="fu">bind_cols</span>(<span class="fu">predict</span>(ajuste, casas_prueba_normal)), </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">truth =</span> precio_miles, <span class="at">estimate =</span> .pred) <span class="sc">|&gt;</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>(.estimate, <span class="at">decimals =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="hsxwwlphgo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hsxwwlphgo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hsxwwlphgo thead, #hsxwwlphgo tbody, #hsxwwlphgo tfoot, #hsxwwlphgo tr, #hsxwwlphgo td, #hsxwwlphgo th {
  border-style: none;
}

#hsxwwlphgo p {
  margin: 0;
  padding: 0;
}

#hsxwwlphgo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hsxwwlphgo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hsxwwlphgo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hsxwwlphgo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hsxwwlphgo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hsxwwlphgo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hsxwwlphgo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hsxwwlphgo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hsxwwlphgo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hsxwwlphgo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hsxwwlphgo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hsxwwlphgo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hsxwwlphgo .gt_spanner_row {
  border-bottom-style: hidden;
}

#hsxwwlphgo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hsxwwlphgo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hsxwwlphgo .gt_from_md > :first-child {
  margin-top: 0;
}

#hsxwwlphgo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hsxwwlphgo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hsxwwlphgo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hsxwwlphgo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hsxwwlphgo .gt_row_group_first td {
  border-top-width: 2px;
}

#hsxwwlphgo .gt_row_group_first th {
  border-top-width: 2px;
}

#hsxwwlphgo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hsxwwlphgo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hsxwwlphgo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hsxwwlphgo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hsxwwlphgo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hsxwwlphgo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hsxwwlphgo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hsxwwlphgo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hsxwwlphgo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hsxwwlphgo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hsxwwlphgo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hsxwwlphgo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hsxwwlphgo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hsxwwlphgo .gt_left {
  text-align: left;
}

#hsxwwlphgo .gt_center {
  text-align: center;
}

#hsxwwlphgo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hsxwwlphgo .gt_font_normal {
  font-weight: normal;
}

#hsxwwlphgo .gt_font_bold {
  font-weight: bold;
}

#hsxwwlphgo .gt_font_italic {
  font-style: italic;
}

#hsxwwlphgo .gt_super {
  font-size: 65%;
}

#hsxwwlphgo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hsxwwlphgo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hsxwwlphgo .gt_indent_1 {
  text-indent: 5px;
}

#hsxwwlphgo .gt_indent_2 {
  text-indent: 10px;
}

#hsxwwlphgo .gt_indent_3 {
  text-indent: 15px;
}

#hsxwwlphgo .gt_indent_4 {
  text-indent: 20px;
}

#hsxwwlphgo .gt_indent_5 {
  text-indent: 25px;
}

#hsxwwlphgo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hsxwwlphgo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id=".metric" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.metric</th>
<th id=".estimator" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.estimator</th>
<th id=".estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">.estimate</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=".metric">mape</td>
<td class="gt_row gt_left" headers=".estimator">standard</td>
<td class="gt_row gt_right" headers=".estimate">10.34</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".metric">mae</td>
<td class="gt_row gt_left" headers=".estimator">standard</td>
<td class="gt_row gt_right" headers=".estimate">17.12</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".metric">rmse</td>
<td class="gt_row gt_left" headers=".estimator">standard</td>
<td class="gt_row gt_right" headers=".estimate">23.49</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".metric">rsq</td>
<td class="gt_row gt_left" headers=".estimator">standard</td>
<td class="gt_row gt_right" headers=".estimate">0.89</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="no-linealidad-y-atípicos" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="no-linealidad-y-atípicos"><span class="header-section-number">4.6</span> No linealidad y atípicos</h2>
<p>En un primer ejemplo consideremos la variable de área de lote:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>g_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(casas_entrena, <span class="fu">aes</span>(<span class="at">x =</span> area_lote_m2, <span class="at">y =</span> precio_miles)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Sin fitrar"</span>) </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>g_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(casas_entrena <span class="sc">|&gt;</span> <span class="fu">filter</span>(area_lote_m2 <span class="sc">&lt;</span> <span class="dv">5000</span>), <span class="fu">aes</span>(<span class="at">x =</span> area_lote_m2, <span class="at">y =</span> precio_miles)) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> casas_entrena, <span class="fu">aes</span>(<span class="at">colour =</span> area_lote_m2 <span class="sc">&gt;</span> <span class="dv">5000</span>)) <span class="sc">+</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Filtrando valores grandes"</span>) </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>g_1 <span class="sc">+</span> g_2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-lineales-ingenieria_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Y notamos que hay algunos valores grandes que pueden perturbar el ajuste lineal. Esto puede producir varianza alta en las predicciones, pues el ajuste depende mucho de unos cuantos valores de entrenamiento (intenta explicar de dónde sale esa varianza). Una solución puede ser transformar la entrada por ejempo usando el logaritmo, que comprime la cola derecha de la distribución de la variable que tiene mucho sesgo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(casas_entrena, <span class="fu">aes</span>(<span class="at">x =</span> area_lote_m2, <span class="at">y =</span> precio_miles)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">span =</span> <span class="fl">0.5</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-lineales-ingenieria_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>Nótese que:</p>
<ul>
<li>Probablemente tendremos que agregar más flexibilidad en nuestro predictor para capturar apropiadamente la información en esta variable, como mostramos en la gráfica anterior. Esto muestra que con flexibilidad apropiada, la existencia de atípicos no necesariamente afecta mucho la estimación donde existe la mayoría de los valores.</li>
<li>En algunos casos, si después de investigar estas observaciones vemos que son datos erróneos (y conocemos la razón del error o medición defectuosa), podemos corregirlos o eliminarlos. Esto es parte del preprocesamiento y es necesario también probar el impacto en desempeño de estas modificaciones.</li>
</ul>
</section>
<section id="no-linealidad-y-splines" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="no-linealidad-y-splines"><span class="header-section-number">4.7</span> No linealidad y splines</h2>
<p>En algunos casos, la relación de una variable de entrada con la predicción es no lineal. Podemos entonces incluír entradas derivadas de la original usando transformaciones no lineales: por ejemplo, transformar entradas usando el logaritmo, o agregar el cuadrado o la raíz de las variables de entrada.</p>
<p>Una de las maneras más simples y menos problemáticas de hacer esto es usando <em>splines naturales</em> para modelar, que son funciones cúbicas por tramos dos veces diferenciables. Los tramos están definidos por <em>nudos</em> que podemos definir por ejemplo igualmente espaciados en los datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>valores_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">110</span>, <span class="dv">1</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>base_splines <span class="ot">&lt;-</span> splines<span class="sc">::</span><span class="fu">ns</span>(<span class="at">x =</span> valores_x, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">knots =</span> <span class="fu">c</span>(<span class="dv">33</span>, <span class="dv">66</span>), <span class="at">Boundary.knots =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>spline_1 <span class="ot">&lt;-</span> base_splines <span class="sc">%*%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>spline_2 <span class="ot">&lt;-</span> base_splines <span class="sc">%*%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> valores_x, <span class="at">y =</span> spline_1, <span class="at">spline =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="at">x =</span> valores_x, <span class="at">y =</span> spline_2, <span class="at">spline =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> spline, <span class="at">colour =</span> <span class="fu">factor</span>(spline))) <span class="sc">+</span> </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">33</span>, <span class="dv">66</span>, <span class="dv">100</span>), </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"red"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-lineales-ingenieria_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Estos dos son ejemplos de funciones cúbicas por tramos y dos veces diferenciables, con nudos en 0, 33, 66 y 100. Su forma particular depende de tres coeficientes, que pueden pensarse también como definidos por dónde tienen que pasar la curva en <span class="math inline">\(y\)</span> para los valores <span class="math inline">\(x = 33, 66\)</span> y <span class="math inline">\(100\)</span>. Extrapolan <em>linealmente</em> fuera del rango de los datos.</p>
<p>Para entender mejor esta construcción, primero consideramos el uso de polinomios para hacer expansión de entradas. Por ejemplo, si escogemos grado 3, la idea es convertir una variable <span class="math inline">\(x\)</span> en varias variables <span class="math inline">\(x, x^2, x^3, x^4\)</span>, de modo que nuestro modelo original</p>
<p><span class="math display">\[f(x) = a + bx + \textrm{otros términos}\]</span> Se convierte en</p>
<p><span class="math display">\[f(x) = a + b_1x + b_2x^2 + b_3x^3 + b_4x^4 + \textrm{otros términos}\]</span></p>
<p>Para hacer esto, sólo tenemos que precalcular <span class="math inline">\(x, x^2, x^3, x^4\)</span> y añadir al modelo lineal.</p>
<p>En el caso de splines, con 4 grados de libertad por ejemplo, el modelo se convierte en:</p>
<p><span class="math display">\[f(x) = a + b_1s_1(x) + b_2s_2(x) + b_3s_3(x) + b_4s_4(x) + \textrm{otros términos}\]</span> donde cada <span class="math inline">\(s_i(x)\)</span> es una función cúbica por tramos que vale 0 fuera de un intervalo. Igual que con polinomios, estas variables <span class="math inline">\(s_i(x)\)</span> pueden precalcularse a partir de la <span class="math inline">\(x\)</span> original y los nudos que escogimos. Puedes ver los detalles en nuestra referencia <span class="citation" data-cites="ESL">Hastie, Tibshirani, y Friedman (<a href="99-referencias.html#ref-ESL" role="doc-biblioref">2017</a>)</span>.</p>
<p>La ventaja de utilizar estos splines es que</p>
<ul>
<li>Son más estables en el cálculo, pues a lo más utilizan potencias cúbicas.</li>
<li>La complejidad puede aumentarse incrementando el número de nodos, sin incrementar el grado.</li>
<li>Evitan el problema de la naturaleza global de los polinomios, en los que cambios en una parte de los datos puede afectar severamente la forma del polinomio en otros lugares lejanos. Esto limita los efectos negativos de la varianza adicional en las colas de los datos (por ejemplo atípicos).</li>
</ul>
<section id="ejemplo-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="ejemplo-1">Ejemplo</h3>
<p>Revisamos nuestro ejemplo de rendimiento de coches:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>auto <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../datos/auto.csv"</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> auto[, <span class="fu">c</span>(<span class="st">'name'</span>, <span class="st">'weight'</span>,<span class="st">'year'</span>, <span class="st">'mpg'</span>, <span class="st">'displacement'</span>)]</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">peso_kg =</span> weight <span class="sc">*</span> <span class="fl">0.45359237</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">rendimiento_kpl =</span> mpg <span class="sc">*</span> (<span class="fl">1.609344</span> <span class="sc">/</span> <span class="fl">3.78541178</span>), </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  año <span class="ot">=</span> year)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vamos a separar en muestra de entrenamiento y de prueba estos datos. Podemos hacerlo como sigue (75% para entrenamiento aproximadamente en este caso, así obtenemos alrededor de 100 casos para prueba):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">121</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>datos_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(datos, <span class="at">prop =</span> <span class="fl">0.75</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>datos_entrena <span class="ot">&lt;-</span> <span class="fu">training</span>(datos_split)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>datos_prueba <span class="ot">&lt;-</span> <span class="fu">testing</span>(datos_split)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vamos a usar año y peso de los coches para predecir su rendimiento:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_entrena, <span class="fu">aes</span>(<span class="at">x =</span> peso_kg, <span class="at">y =</span> rendimiento_kpl, <span class="at">colour =</span> año)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-lineales-ingenieria_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Nuestra receta incluye la transformación no lineal de splines:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>receta_lineal <span class="ot">&lt;-</span> <span class="fu">recipe</span>(rendimiento_kpl <span class="sc">~</span> peso_kg <span class="sc">+</span> año, datos_entrena) <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ns</span>(peso_kg, <span class="at">deg_free =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ns</span>(año, <span class="at">deg_free =</span> <span class="dv">2</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>mod_lineal <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span>  </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>)  </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>flujo <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span>  </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(receta_lineal) <span class="sc">|&gt;</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(mod_lineal)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Los datos de entrada son los siguientes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">juice</span>(<span class="fu">prep</span>(receta_lineal)) <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="lbcboxdrag" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lbcboxdrag table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lbcboxdrag thead, #lbcboxdrag tbody, #lbcboxdrag tfoot, #lbcboxdrag tr, #lbcboxdrag td, #lbcboxdrag th {
  border-style: none;
}

#lbcboxdrag p {
  margin: 0;
  padding: 0;
}

#lbcboxdrag .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lbcboxdrag .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lbcboxdrag .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lbcboxdrag .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lbcboxdrag .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lbcboxdrag .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lbcboxdrag .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lbcboxdrag .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lbcboxdrag .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lbcboxdrag .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lbcboxdrag .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lbcboxdrag .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lbcboxdrag .gt_spanner_row {
  border-bottom-style: hidden;
}

#lbcboxdrag .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lbcboxdrag .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lbcboxdrag .gt_from_md > :first-child {
  margin-top: 0;
}

#lbcboxdrag .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lbcboxdrag .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lbcboxdrag .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lbcboxdrag .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lbcboxdrag .gt_row_group_first td {
  border-top-width: 2px;
}

#lbcboxdrag .gt_row_group_first th {
  border-top-width: 2px;
}

#lbcboxdrag .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lbcboxdrag .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lbcboxdrag .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lbcboxdrag .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lbcboxdrag .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lbcboxdrag .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lbcboxdrag .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lbcboxdrag .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lbcboxdrag .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lbcboxdrag .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lbcboxdrag .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lbcboxdrag .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lbcboxdrag .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lbcboxdrag .gt_left {
  text-align: left;
}

#lbcboxdrag .gt_center {
  text-align: center;
}

#lbcboxdrag .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lbcboxdrag .gt_font_normal {
  font-weight: normal;
}

#lbcboxdrag .gt_font_bold {
  font-weight: bold;
}

#lbcboxdrag .gt_font_italic {
  font-style: italic;
}

#lbcboxdrag .gt_super {
  font-size: 65%;
}

#lbcboxdrag .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lbcboxdrag .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lbcboxdrag .gt_indent_1 {
  text-indent: 5px;
}

#lbcboxdrag .gt_indent_2 {
  text-indent: 10px;
}

#lbcboxdrag .gt_indent_3 {
  text-indent: 15px;
}

#lbcboxdrag .gt_indent_4 {
  text-indent: 20px;
}

#lbcboxdrag .gt_indent_5 {
  text-indent: 25px;
}

#lbcboxdrag .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lbcboxdrag div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="rendimiento_kpl" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">rendimiento_kpl</th>
<th id="peso_kg_ns_1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">peso_kg_ns_1</th>
<th id="peso_kg_ns_2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">peso_kg_ns_2</th>
<th id="peso_kg_ns_3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">peso_kg_ns_3</th>
<th id="año_ns_1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">año_ns_1</th>
<th id="año_ns_2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">año_ns_2</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="rendimiento_kpl">12.754311</td>
<td class="gt_row gt_right" headers="peso_kg_ns_1">-0.1384501</td>
<td class="gt_row gt_right" headers="peso_kg_ns_2">0.3919536</td>
<td class="gt_row gt_right" headers="peso_kg_ns_3">-0.2338715</td>
<td class="gt_row gt_right" headers="año_ns_1">0.1263158</td>
<td class="gt_row gt_right" headers="año_ns_2">-0.08343893</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="rendimiento_kpl">13.136941</td>
<td class="gt_row gt_right" headers="peso_kg_ns_1">-0.1508427</td>
<td class="gt_row gt_right" headers="peso_kg_ns_2">0.4978146</td>
<td class="gt_row gt_right" headers="peso_kg_ns_3">-0.2970367</td>
<td class="gt_row gt_right" headers="año_ns_1">0.5652102</td>
<td class="gt_row gt_right" headers="año_ns_2">0.00590925</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="rendimiento_kpl">12.754311</td>
<td class="gt_row gt_right" headers="peso_kg_ns_1">0.3794499</td>
<td class="gt_row gt_right" headers="peso_kg_ns_2">0.4646633</td>
<td class="gt_row gt_right" headers="peso_kg_ns_3">-0.2232209</td>
<td class="gt_row gt_right" headers="año_ns_1">0.4765544</td>
<td class="gt_row gt_right" headers="año_ns_2">0.35513660</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="rendimiento_kpl">7.695101</td>
<td class="gt_row gt_right" headers="peso_kg_ns_1">0.4471996</td>
<td class="gt_row gt_right" headers="peso_kg_ns_2">0.4245669</td>
<td class="gt_row gt_right" headers="peso_kg_ns_3">-0.1625354</td>
<td class="gt_row gt_right" headers="año_ns_1">0.5652102</td>
<td class="gt_row gt_right" headers="año_ns_2">0.00590925</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="rendimiento_kpl">8.757960</td>
<td class="gt_row gt_right" headers="peso_kg_ns_1">0.4368600</td>
<td class="gt_row gt_right" headers="peso_kg_ns_2">0.4313780</td>
<td class="gt_row gt_right" headers="peso_kg_ns_3">-0.1743974</td>
<td class="gt_row gt_right" headers="año_ns_1">0.5652102</td>
<td class="gt_row gt_right" headers="año_ns_2">0.00590925</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="rendimiento_kpl">14.242314</td>
<td class="gt_row gt_right" headers="peso_kg_ns_1">-0.1126420</td>
<td class="gt_row gt_right" headers="peso_kg_ns_2">0.2985773</td>
<td class="gt_row gt_right" headers="peso_kg_ns_3">-0.1781555</td>
<td class="gt_row gt_right" headers="año_ns_1">0.5794245</td>
<td class="gt_row gt_right" headers="año_ns_2">-0.12316573</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Nótese que tenemos 4 entradas en lugar de las 2 originales, pues creamos dos transformaciones no lineales de <em>peso_kg</em>. El modelo es lineal en estas 4 variables, pero no en las 2 originales. Ajustamos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>flujo_ajustado <span class="ot">&lt;-</span> <span class="fu">fit</span>(flujo, datos_entrena)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y ahora podemos graficar los resultados y vemos cómo pudimos capturar la relación no lineal entre peso y rendimiento:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>dat_graf <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">peso_kg =</span> <span class="fu">seq</span>(<span class="dv">900</span>, <span class="dv">2200</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">|&gt;</span>   </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="fu">tibble</span>(año <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">80</span>)))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>dat_graf <span class="ot">&lt;-</span> dat_graf <span class="sc">|&gt;</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_1 =</span> <span class="fu">predict</span>(flujo_ajustado, dat_graf) <span class="sc">|&gt;</span> <span class="fu">pull</span>(.pred))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_entrena, <span class="fu">aes</span>(<span class="at">x =</span> peso_kg, <span class="at">group =</span> año, <span class="at">colour =</span> año)) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> rendimiento_kpl), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dat_graf, <span class="fu">aes</span>(<span class="at">y =</span> pred_1),  <span class="at">size =</span> <span class="fl">1.2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-lineales-ingenieria_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Los grados de libertad también pueden afinarse utilizando un conjunto de validación como hicimos antes en vecinos más cercanos.</p>
</section>
<section id="ejemplo-casas" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="ejemplo-casas">Ejemplo: casas</h3>
<p>Por ejemplo, podríamos incluir un efecto no lineal de area_lote, calidad y condición general y año de construcción:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>receta_casas <span class="ot">&lt;-</span> <span class="fu">recipe</span>(precio_miles <span class="sc">~</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>           nombre_zona <span class="sc">+</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>           area_hab_m2 <span class="sc">+</span> area_garage_m2 <span class="sc">+</span> area_sotano_m2 <span class="sc">+</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>           area_lote_m2 <span class="sc">+</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>           año_construccion <span class="sc">+</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>           calidad_gral <span class="sc">+</span> calidad_garage <span class="sc">+</span> calidad_sotano <span class="sc">+</span> </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>           condicion_gral <span class="sc">+</span> </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>           num_coches  <span class="sc">+</span> </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>           aire_acondicionado <span class="sc">+</span> condicion_venta, </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> casas_entrena) <span class="sc">|&gt;</span> </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_filter</span>(condicion_venta <span class="sc">==</span> <span class="st">"Normal"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_select</span>(<span class="sc">-</span>condicion_venta, <span class="at">skip =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_novel</span>(nombre_zona, calidad_sotano, calidad_garage) <span class="sc">|&gt;</span> </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(calidad_sotano, calidad_garage) <span class="sc">|&gt;</span> </span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_other</span>(nombre_zona, <span class="at">threshold =</span> <span class="fl">0.02</span>, <span class="at">other =</span> <span class="st">"otras"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">area_sotano_m2 =</span> </span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">is.na</span>(area_sotano_m2), <span class="dv">0</span>, area_sotano_m2)) <span class="sc">|&gt;</span> </span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">area_garage_m2 =</span> </span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">is.na</span>(area_garage_m2), <span class="dv">0</span>, area_garage_m2)) <span class="sc">|&gt;</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a> <span class="co"># step_log(area_lote_m2) |&gt; </span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ns</span>(año_construccion, <span class="at">deg_free =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ns</span>(calidad_gral, <span class="at">deg_free =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ns</span>(condicion_gral, <span class="at">deg_free =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ns</span>(area_lote_m2, <span class="at">deg_free =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(nombre_zona,  calidad_garage, calidad_sotano, aire_acondicionado) <span class="sc">|&gt;</span> </span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> area_hab_m2<span class="sc">:</span><span class="fu">starts_with</span>(<span class="st">"calidad_gral"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> area_hab_m2<span class="sc">:</span><span class="fu">starts_with</span>(<span class="st">"nombre_zona"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> area_garage_m2<span class="sc">:</span><span class="fu">starts_with</span>(<span class="st">"calidad_garage"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> area_sotano_m2<span class="sc">:</span> <span class="fu">starts_with</span>(<span class="st">"calidad_sotano"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_nzv</span>(<span class="fu">all_predictors</span>(), <span class="at">freq_cut =</span> <span class="dv">500</span> <span class="sc">/</span> <span class="dv">1</span>, <span class="at">unique_cut =</span> <span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>flujo_casas <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(receta_casas) <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(<span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"lm"</span>))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>ajuste <span class="ot">&lt;-</span> <span class="fu">fit</span>(flujo_casas, casas_entrena)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finalmente, evaluamos el desempeño sobre las ventas normales, y obtenemos una mejoría con respecto a nuestro modelo anterior:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>metricas <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(mape, mae, rmse, rsq)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>casas_prueba_normal <span class="ot">&lt;-</span> <span class="fu">testing</span>(casas_split) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(condicion_venta <span class="sc">==</span> <span class="st">"Normal"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metricas</span>(casas_prueba_normal <span class="sc">|&gt;</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(ajuste, casas_prueba_normal)), </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">truth =</span> precio_miles, <span class="at">estimate =</span> .pred) <span class="sc">|&gt;</span> </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>(.estimate, <span class="at">decimals =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fntqtpfrvf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fntqtpfrvf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fntqtpfrvf thead, #fntqtpfrvf tbody, #fntqtpfrvf tfoot, #fntqtpfrvf tr, #fntqtpfrvf td, #fntqtpfrvf th {
  border-style: none;
}

#fntqtpfrvf p {
  margin: 0;
  padding: 0;
}

#fntqtpfrvf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fntqtpfrvf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fntqtpfrvf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fntqtpfrvf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fntqtpfrvf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fntqtpfrvf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fntqtpfrvf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fntqtpfrvf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fntqtpfrvf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fntqtpfrvf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fntqtpfrvf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fntqtpfrvf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fntqtpfrvf .gt_spanner_row {
  border-bottom-style: hidden;
}

#fntqtpfrvf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fntqtpfrvf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fntqtpfrvf .gt_from_md > :first-child {
  margin-top: 0;
}

#fntqtpfrvf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fntqtpfrvf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fntqtpfrvf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fntqtpfrvf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fntqtpfrvf .gt_row_group_first td {
  border-top-width: 2px;
}

#fntqtpfrvf .gt_row_group_first th {
  border-top-width: 2px;
}

#fntqtpfrvf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fntqtpfrvf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fntqtpfrvf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fntqtpfrvf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fntqtpfrvf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fntqtpfrvf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fntqtpfrvf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fntqtpfrvf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fntqtpfrvf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fntqtpfrvf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fntqtpfrvf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fntqtpfrvf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fntqtpfrvf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fntqtpfrvf .gt_left {
  text-align: left;
}

#fntqtpfrvf .gt_center {
  text-align: center;
}

#fntqtpfrvf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fntqtpfrvf .gt_font_normal {
  font-weight: normal;
}

#fntqtpfrvf .gt_font_bold {
  font-weight: bold;
}

#fntqtpfrvf .gt_font_italic {
  font-style: italic;
}

#fntqtpfrvf .gt_super {
  font-size: 65%;
}

#fntqtpfrvf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fntqtpfrvf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fntqtpfrvf .gt_indent_1 {
  text-indent: 5px;
}

#fntqtpfrvf .gt_indent_2 {
  text-indent: 10px;
}

#fntqtpfrvf .gt_indent_3 {
  text-indent: 15px;
}

#fntqtpfrvf .gt_indent_4 {
  text-indent: 20px;
}

#fntqtpfrvf .gt_indent_5 {
  text-indent: 25px;
}

#fntqtpfrvf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fntqtpfrvf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id=".metric" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.metric</th>
<th id=".estimator" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.estimator</th>
<th id=".estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">.estimate</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=".metric">mape</td>
<td class="gt_row gt_left" headers=".estimator">standard</td>
<td class="gt_row gt_right" headers=".estimate">8.47</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".metric">mae</td>
<td class="gt_row gt_left" headers=".estimator">standard</td>
<td class="gt_row gt_right" headers=".estimate">14.45</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".metric">rmse</td>
<td class="gt_row gt_left" headers=".estimator">standard</td>
<td class="gt_row gt_right" headers=".estimate">19.77</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".metric">rsq</td>
<td class="gt_row gt_left" headers=".estimator">standard</td>
<td class="gt_row gt_right" headers=".estimate">0.92</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Finalmente, examinamos la respuesta contra la predicción:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>casas_prueba_normal <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(ajuste, casas_prueba_normal)) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred, <span class="at">y =</span> precio_miles)) <span class="sc">+</span> <span class="fu">geom_abline</span>() <span class="sc">+</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="fu">coord_obs_pred</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-lineales-ingenieria_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-ESL" class="csl-entry" role="listitem">
Hastie, Trevor, Robert Tibshirani, y Jerome Friedman. 2017. <em>The Elements of Statistical Learning</em>. Springer Series en Statistics. Springer New York Inc. <a href="http://web.stanford.edu/~hastie/ElemStatLearn/">http://web.stanford.edu/~hastie/ElemStatLearn/</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-metodos-locales.html" class="pagination-link" aria-label="Métodos locales no estructurados">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Métodos locales no estructurados</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-regularizacion-1.html" class="pagination-link" aria-label="Regularización y variabilidad">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regularización y variabilidad</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>